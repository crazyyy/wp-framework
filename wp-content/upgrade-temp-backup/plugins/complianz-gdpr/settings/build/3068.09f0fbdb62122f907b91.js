"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[3068,9091,9758,1366,1629],{99091:(e,t,n)=>{n.r(t),n.d(t,{UseCookieScanData:()=>r});var a=n(81621),o=n(9588);const r=(0,a.vt)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))},79758:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var a=n(51609),o=n(86087),r=n(9588),s=n(4219),i=n(52043),c=n(56427),l=n(99091),d=n(32828);const u=(0,o.memo)((({type:e="action",style:t="tertiary",label:n,onClick:u,href:m="",target:p="",disabled:g,action:f,field:h,children:b})=>{if(!n&&!b)return null;const _=(h&&h.button_text?h.button_text:n)||b,{fetchFieldsData:v,showSavedSettingsNotice:E}=(0,s.default)(),{setInitialLoadCompleted:y,setProgress:k}=(0,l.UseCookieScanData)(),{setProgressLoaded:C}=(0,d.default)(),{selectedSubMenuItem:N}=(0,i.default)(),[w,L]=(0,o.useState)(!1),z=`button cmplz-button button--${t} button-${e}`,A=async e=>{await r.doAction(h.action,{}).then((e=>{e.success&&(v(N),"reset_settings"===e.id&&(y(!1),k(0),C(!1)),E(e.message))}))},S=h&&h.warn?h.warn:"";return"action"===e?(0,a.createElement)(a.Fragment,null,c.__experimentalConfirmDialog&&(0,a.createElement)(c.__experimentalConfirmDialog,{isOpen:w,onConfirm:async()=>{L(!1),await A()},onCancel:()=>{L(!1)}},S),(0,a.createElement)("button",{className:z,onClick:async t=>{if("action"!==e||!u)return"action"===e&&f?c.__experimentalConfirmDialog?void(h&&h.warn?L(!0):await A()):void await A():void(window.location.href=h.url);u(t)},disabled:g},_)):"link"===e?(0,a.createElement)("a",{className:z,href:m,target:p},_):void 0}))},81366:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var a=n(51609),o=n(58168),r=n(91071),s=n(62133),i=n(9957),c=n(81351),l=n(85357),d=n(31769),u=n(7971),m=n(12579);const p="Checkbox",[g,f]=(0,s.A)(p),[h,b]=g(p),_=(0,a.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,name:s,checked:l,defaultChecked:d,required:u,disabled:p,value:g="on",onCheckedChange:f,...b}=e,[_,k]=(0,a.useState)(null),C=(0,r.s)(t,(e=>k(e))),N=(0,a.useRef)(!1),w=!_||Boolean(_.closest("form")),[L=!1,z]=(0,c.i)({prop:l,defaultProp:d,onChange:f}),A=(0,a.useRef)(L);return(0,a.useEffect)((()=>{const e=null==_?void 0:_.form;if(e){const t=()=>z(A.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}}),[_,z]),(0,a.createElement)(h,{scope:n,state:L,disabled:p},(0,a.createElement)(m.sG.button,(0,o.A)({type:"button",role:"checkbox","aria-checked":E(L)?"mixed":L,"aria-required":u,"data-state":y(L),"data-disabled":p?"":void 0,disabled:p,value:g},b,{ref:C,onKeyDown:(0,i.m)(e.onKeyDown,(e=>{"Enter"===e.key&&e.preventDefault()})),onClick:(0,i.m)(e.onClick,(e=>{z((e=>!!E(e)||!e)),w&&(N.current=e.isPropagationStopped(),N.current||e.stopPropagation())}))})),w&&(0,a.createElement)(v,{control:_,bubbles:!N.current,name:s,value:g,checked:L,required:u,disabled:p,style:{transform:"translateX(-100%)"}}))})),v=e=>{const{control:t,checked:n,bubbles:r=!0,...s}=e,i=(0,a.useRef)(null),c=(0,l.Z)(n),u=(0,d.X)(t);return(0,a.useEffect)((()=>{const e=i.current,t=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(t,"checked").set;if(c!==n&&a){const t=new Event("click",{bubbles:r});e.indeterminate=E(n),a.call(e,!E(n)&&n),e.dispatchEvent(t)}}),[c,n,r]),(0,a.createElement)("input",(0,o.A)({type:"checkbox","aria-hidden":!0,defaultChecked:!E(n)&&n},s,{tabIndex:-1,ref:i,style:{...e.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function E(e){return"indeterminate"===e}function y(e){return E(e)?"indeterminate":e?"checked":"unchecked"}const k=_,C=(0,a.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=b("CheckboxIndicator",n);return(0,a.createElement)(u.C,{present:r||E(i.state)||!0===i.state},(0,a.createElement)(m.sG.span,(0,o.A)({"data-state":y(i.state),"data-disabled":i.disabled?"":void 0},s,{ref:t,style:{pointerEvents:"none",...e.style}})))}));var N=n(27723),w=n(45111),L=n(86087),z=n(79758);const A=(0,L.memo)((({indeterminate:e,label:t,value:n,id:o,onChange:r,required:s,disabled:i,options:c={}})=>{const[l,d]=(0,L.useState)(!1),[u,m]=(0,L.useState)(!1);let p=n;Array.isArray(p)||(p=""===p?[]:[p]),(0,L.useEffect)((()=>{let e=1===Object.keys(c).length&&"true"===Object.keys(c)[0];d(e)}),[]),e&&(n=!0);const g=p;let f=!1;Object.keys(c).length>10&&(f=!0);const h=e=>l?n:g.includes(""+e)||g.includes(parseInt(e)),b=()=>{m(!u)};let _=i&&!Array.isArray(i);return 0===Object.keys(c).length?(0,a.createElement)(a.Fragment,null,(0,N.__)("No options found","complianz-gdpr")):(0,a.createElement)("div",{className:"cmplz-checkbox-group"},Object.entries(c).map((([c,d],m)=>(0,a.createElement)("div",{key:c,className:"cmplz-checkbox-group__item"+(!u&&m>9?" cmplz-hidden":"")},(0,a.createElement)(k,{className:"cmplz-checkbox-group__checkbox",id:o+"_"+c,checked:h(c),"aria-label":t,disabled:_||Array.isArray(i)&&i.includes(c),required:s,onCheckedChange:e=>((e,t)=>{if(l)r(!n);else{const e=g.includes(""+t)||g.includes(parseInt(t))?g.filter((e=>e!==""+t&&e!==parseInt(t))):[...g,t];r(e)}})(0,c)},(0,a.createElement)(C,{className:"cmplz-checkbox-group__indicator"},(0,a.createElement)(w.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"}))),(0,a.createElement)("label",{className:"cmplz-checkbox-group__label",htmlFor:o+"_"+c},d)))),!u&&f&&(0,a.createElement)(z.default,{onClick:()=>b()},(0,N.__)("Show more","complianz-gdpr")),u&&f&&(0,a.createElement)(z.default,{onClick:()=>b()},(0,N.__)("Show less","complianz-gdpr")))}))},13068:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var a=n(51609),o=n(81629),r=n(86087),s=n(27723),i=n(45111),c=n(81366);const l=(0,r.memo)((()=>{const{documents:e,documentsLoaded:t,fetchData:l,deleteDocuments:d,editDocument:u}=(0,o.default)(),[m,p]=(0,r.useState)(""),[g,f]=(0,r.useState)({}),[h,b]=(0,r.useState)(!1),[_,v]=(0,r.useState)(!1),[E,y]=(0,r.useState)(""),[k,C]=(0,r.useState)([]),[N,w]=(0,r.useState)(!1),[L,z]=(0,r.useState)(null);(0,r.useEffect)((()=>{n.e(3757).then(n.bind(n,83757)).then((({default:e})=>{z((()=>e))}))}),[]),cmplz_settings.is_premium,(0,r.useEffect)((()=>{t||l()}),[t]);const A=async()=>{let t=e.filter((e=>k.includes(e.id)));w(!0);const n=async()=>{if(t.length>0){const e=t.shift(),a=e.download_url;y(!0);try{let o=new XMLHttpRequest;o.responseType="blob",o.open("get",a,!0),o.send(),o.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let n=window.URL.createObjectURL(this.response),a=window.document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",e.title),window.document.body.appendChild(a),a.click(),C(t),w(!1),setTimeout((function(){window.URL.revokeObjectURL(n)}),6e4)}},await n()}catch(e){console.error(e),y(!1)}}};await n(),y(!1)},S=e=>((e=e.filter((e=>e.title.toLowerCase().includes(m.toLowerCase())||e.service.toLowerCase().includes(m.toLowerCase())))).sort(((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)),e),D=[{name:(0,a.createElement)(c.default,{options:{true:""},indeterminate:h,value:_,onChange:t=>(t=>{if(t){v(!0);let t=g.currentPage?g.currentPage:1,n=S(e).slice(5*(t-1),5*t);C(n.map((e=>e.id)))}else v(!1),C([]);b(!1)})(t)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,s.__)("Document","complianz-gdpr"),selector:e=>e.title,sortable:!0,grow:6},{name:(0,s.__)("Region","complianz-gdpr"),selector:e=>(0,a.createElement)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}),sortable:!0,grow:2,right:!0},{name:(0,s.__)("Date","complianz-gdpr"),selector:e=>e.date,sortable:!0,grow:4,minWidth:"200px",right:!0}];let I=S(e),x=[];return I.forEach((t=>{let n={...t};n.selectControl=(0,a.createElement)(c.default,{value:k.includes(n.id),options:{true:""},onChange:t=>((t,n)=>{let a=t,o=[...k];a?o.includes(n)||(o.push(n),C(o)):(o=[...k.filter((e=>e!==n))],C(o));let r=g.currentPage?g.currentPage:1,s=S(e).slice(5*(r-1),5*r),i=!0,c=!1;s.forEach((e=>{o.includes(e.id)?c=!0:i=!1})),i?(v(!0),b(!1)):c?(v(!1),b(!0)):b(!1)})(t,n.id)}),x.push(n)})),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"cmplz-table-header"},(0,a.createElement)("div",{className:"cmplz-table-header-controls"},(0,a.createElement)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,s.__)("Search","complianz-gdpr"),value:m,onChange:e=>p(e.target.value)}))),k.length>0&&(0,a.createElement)("div",{className:"cmplz-selected-document"},k.length>1&&(0,s.__)("%s items selected","complianz-gdpr").replace("%s",k.length),1===k.length&&(0,s.__)("1 item selected","complianz-gdpr"),(0,a.createElement)("div",{className:"cmplz-selected-document-controls"},(0,a.createElement)("button",{disabled:E||k.length>1,className:"button button-default",onClick:e=>u(k[0])},(0,s.__)("Edit","complianz-gdpr")),(0,a.createElement)("button",{disabled:E,className:"button button-default cmplz-btn-reset",onClick:()=>A()},(0,s.__)("Download Processing Agreement","complianz-gdpr"),N&&(0,a.createElement)(i.default,{name:"loading",color:"grey"})),(0,a.createElement)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{C([]),await d(e)})(k)},(0,s.__)("Delete","complianz-gdpr")))),L&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(L,{columns:D,data:x,dense:!0,pagination:!0,noDataComponent:(0,a.createElement)("div",{className:"cmplz-no-documents"},(0,s.__)("No documents","complianz-gdpr")),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:5,onChangePage:e=>{f({...g,currentPage:e})},paginationState:g})))}))},81629:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var a=n(81621),o=n(16535),r=n(9588),s=n(73710);const i=(0,a.vt)(((e,t)=>({documentsLoaded:!1,region:"",fileName:"",serviceName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:"",serviceName:""})},editDocument:async t=>{e({updating:!0}),await r.doAction("load_processing_agreement",{id:t}).then((t=>{e({fields:t.fields,region:t.region,serviceName:t.serviceName,updating:!1,fileName:t.file_name})})).catch((e=>{console.error(e)})),e({editDocumentId:t})},setRegion:t=>{e({region:t})},setServiceName:t=>{e({serviceName:t})},updateField:(n,a)=>{let r=!1,i=!1;e((0,o.Ay)((e=>{e.fields.forEach((function(e,t){e.id===n&&(i=t,r=!0)})),!1!==i&&(e.fields[i].value=a)})));let c=(0,s.updateFieldsListWithConditions)(t().fields);e({fields:c})},save:async(n,a)=>{e({updating:!0});let o=t().editDocumentId;await r.doAction("save_processing_agreement",{fields:t().fields,region:n,serviceName:a,post_id:o}).then((t=>(e({updating:!1}),t))).catch((e=>{console.error(e)})),t().fetchData()},deleteDocuments:async n=>{let a=t().documents.filter((e=>n.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!n.includes(e.id)))})));let o={};o.documents=a,await r.doAction("delete_processing_agreement",o).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:n,regions:a}=await r.doAction("get_processing_agreements",{}).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({documentsLoaded:!0,documents:n,regions:a,fetching:!1})))},fetchFields:async t=>{let n={region:t};e({loadingFields:!0});const{fields:a}=await r.doAction("get_processing_agreement_fields",n).then((e=>e)).catch((e=>{console.error(e)}));let o=(0,s.updateFieldsListWithConditions)(a);e((e=>({fields:o,loadingFields:!1})))}})))},7971:(e,t,n)=>{n.d(t,{C:()=>i});var a=n(51609),o=n(75795),r=n(91071),s=n(88200);const i=e=>{const{present:t,children:n}=e,i=function(e){const[t,n]=(0,a.useState)(),r=(0,a.useRef)({}),i=(0,a.useRef)(e),l=(0,a.useRef)("none"),d=e?"mounted":"unmounted",[u,m]=function(e,t){return(0,a.useReducer)(((e,n)=>{const a=t[e][n];return null!=a?a:e}),e)}(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,a.useEffect)((()=>{const e=c(r.current);l.current="mounted"===u?e:"none"}),[u]),(0,s.N)((()=>{const t=r.current,n=i.current;if(n!==e){const a=l.current,o=c(t);e?m("MOUNT"):"none"===o||"none"===(null==t?void 0:t.display)?m("UNMOUNT"):m(n&&a!==o?"ANIMATION_OUT":"UNMOUNT"),i.current=e}}),[e,m]),(0,s.N)((()=>{if(t){const e=e=>{const n=c(r.current).includes(e.animationName);e.target===t&&n&&(0,o.flushSync)((()=>m("ANIMATION_END")))},n=e=>{e.target===t&&(l.current=c(r.current))};return t.addEventListener("animationstart",n),t.addEventListener("animationcancel",e),t.addEventListener("animationend",e),()=>{t.removeEventListener("animationstart",n),t.removeEventListener("animationcancel",e),t.removeEventListener("animationend",e)}}m("ANIMATION_END")}),[t,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:(0,a.useCallback)((e=>{e&&(r.current=getComputedStyle(e)),n(e)}),[])}}(t),l="function"==typeof n?n({present:i.isPresent}):a.Children.only(n),d=(0,r.s)(i.ref,l.ref);return"function"==typeof n||i.isPresent?(0,a.cloneElement)(l,{ref:d}):null};function c(e){return(null==e?void 0:e.animationName)||"none"}i.displayName="Presence"},85357:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(51609);function o(e){const t=(0,a.useRef)({value:e,previous:e});return(0,a.useMemo)((()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous)),[e])}}}]);