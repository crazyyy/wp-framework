"use strict";var WPMailLogging=window.WPMailLogging||{};WPMailLogging.Admin=WPMailLogging.Admin||{},WPMailLogging.Admin.SMTP=WPMailLogging.Admin.SMTP||function(t,s,l){var e={},g={init:function(){l(g.ready)},ready:function(){g.initVars(),g.bindActions()},initVars:function(){e={$stepInstall:l("section.step-install"),$stepInstallNum:l("section.step-install .num img"),$stepSetup:l("section.step-setup"),$stepSetupNum:l("section.step-setup .num img")}},bindActions:function(){e.$stepInstall.on("click","button",g.stepInstallClick),e.$stepSetup.on("click","button",g.gotoURL),l(t).on("click","#wp-mail-logging-db-upgrade-admin-notice .notice-dismiss",g.dbUpgradeAdminNoticeDismiss)},stepInstallClick:function(){var a=l(this),i=a.attr("data-action"),t=a.attr("data-plugin"),n="";if(!a.hasClass("disabled")){switch(i){case"activate":n="wp_mail_logging_activate_smtp",a.text(wp_mail_logging_admin_smtp.activating);break;case"install":n="wp_mail_logging_install_smtp",a.text(wp_mail_logging_admin_smtp.installing);break;case"goto-url":return void(s.location.href=a.attr("data-url"));default:return}a.addClass("disabled"),g.showSpinner(e.$stepInstallNum);t={action:n,nonce:wp_mail_logging_admin_smtp.nonce,plugin:t};l.post(wp_mail_logging_admin_smtp.ajaxurl,t).done(function(t){g.stepInstallDone(t,a,i)}).always(function(){g.hideSpinner(e.$stepInstallNum)})}},showSpinner:function(t){t.siblings(".loader").removeClass("hidden")},stepInstallDone:function(t,a,i){var n;("install"===i?t.success&&t.data.is_activated:t.success)?(e.$stepInstallNum.attr("src",e.$stepInstallNum.attr("src").replace("step-1.","step-complete.")),a.addClass("grey").removeClass("button-primary").text(wp_mail_logging_admin_smtp.activated),g.stepInstallPluginStatus()):(i=(t="install"===i&&t.success&&!t.data.is_activated||"activate"===i)?wp_mail_logging_admin_smtp.manual_activate_url:wp_mail_logging_admin_smtp.manual_install_url,n=t?wp_mail_logging_admin_smtp.error_could_not_activate:wp_mail_logging_admin_smtp.error_could_not_install,t=t?wp_mail_logging_admin_smtp.plugins_page:wp_mail_logging_admin_smtp.download_now,a.removeClass("grey disabled").text(t).attr("data-action","goto-url").attr("data-url",i),a.after('<p class="error">'+n+"</p>"))},stepInstallPluginStatus:function(){l.post(wp_mail_logging_admin_smtp.ajaxurl,{action:"wp_mail_logging_smtp_page_check_plugin_status",nonce:wp_mail_logging_admin_smtp.nonce}).done(g.stepInstallPluginStatusDone)},stepInstallPluginStatusDone:function(t){t.success&&(e.$stepSetup.removeClass("grey"),e.$stepSetupBtn=e.$stepSetup.find("button"),e.$stepSetupBtn.removeClass("grey disabled").addClass("button-primary"),0<t.data.setup_status?(e.$stepSetupNum.attr("src",e.$stepSetupNum.attr("src").replace("step-2.svg","step-complete.svg")),e.$stepSetupBtn.attr("data-url",wp_mail_logging_admin_smtp.smtp_settings_url).text(wp_mail_logging_admin_smtp.smtp_settings)):e.$stepSetupBtn.attr("data-url",wp_mail_logging_admin_smtp.smtp_wizard_url).text(wp_mail_logging_admin_smtp.smtp_wizard))},hideSpinner:function(t){t.siblings(".loader").addClass("hidden")},gotoURL:function(){var t=l(this);t.hasClass("disabled")||(s.location.href=t.attr("data-url"))},dbUpgradeAdminNoticeDismiss:function(t){var a=l(this).parents("#wp-mail-logging-db-upgrade-admin-notice").first();a.length<=0||!a.data("nonce")||l.post(ajaxurl,{action:"wp_mail_logging_dismiss_db_upgrade_notice",nonce:a.data("nonce"),type:"admin-notice"})}};return g}(document,window,jQuery),WPMailLogging.Admin.SMTP.init();