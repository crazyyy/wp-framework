"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[1300,3404,2572,8912,8692],{13404:(e,t,n)=>{n.r(t),n.d(t,{UseCookieScanData:()=>r});var a=n(30809),o=n(61744);const r=(0,a.Su)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))},32572:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var a=n(51280),o=n(88496),r=n(61744),c=n(25536),s=n(38924),l=n(87287),i=n(13404),d=n(64224);const u=(0,o.memo)((({type:e="action",style:t="tertiary",label:n,onClick:u,href:m="",target:p="",disabled:f,action:g,field:h,children:b})=>{if(!n&&!b)return null;const _=(h&&h.button_text?h.button_text:n)||b,{fetchFieldsData:E,showSavedSettingsNotice:k}=(0,c.default)(),{setInitialLoadCompleted:v,setProgress:w}=(0,i.UseCookieScanData)(),{setProgressLoaded:y}=(0,d.default)(),{selectedSubMenuItem:C}=(0,s.default)(),[N,L]=(0,o.useState)(!1),z=`button cmplz-button button--${t} button-${e}`,S=async e=>{await r.doAction(h.action,{}).then((e=>{e.success&&(E(C),"reset_settings"===e.id&&(v(!1),w(0),y(!1)),k(e.message))}))},x=h&&h.warn?h.warn:"";return"action"===e?(0,a.createElement)(a.Fragment,null,l.__experimentalConfirmDialog&&(0,a.createElement)(l.__experimentalConfirmDialog,{isOpen:N,onConfirm:async()=>{L(!1),await S()},onCancel:()=>{L(!1)}},x),(0,a.createElement)("button",{className:z,onClick:async t=>{if("action"!==e||!u)return"action"===e&&g?l.__experimentalConfirmDialog?void(h&&h.warn?L(!0):await S()):void await S():void(window.location.href=h.url);u(t)},disabled:f},_)):"link"===e?(0,a.createElement)("a",{className:z,href:m,target:p},_):void 0}))},38912:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var a=n(51280),o=n(45072),r=n(40304),c=n(59016),s=n(3608),l=n(84664),i=n(37408),d=n(15920),u=n(76860),m=n(61480);const p="Checkbox",[f,g]=(0,c._)(p),[h,b]=f(p),_=(0,a.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,name:c,checked:i,defaultChecked:d,required:u,disabled:p,value:f="on",onCheckedChange:g,...b}=e,[_,w]=(0,a.useState)(null),y=(0,r.q)(t,(e=>w(e))),C=(0,a.useRef)(!1),N=!_||Boolean(_.closest("form")),[L=!1,z]=(0,l.W)({prop:i,defaultProp:d,onChange:g}),S=(0,a.useRef)(L);return(0,a.useEffect)((()=>{const e=null==_?void 0:_.form;if(e){const t=()=>z(S.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}}),[_,z]),(0,a.createElement)(h,{scope:n,state:L,disabled:p},(0,a.createElement)(m.K0.button,(0,o.c)({type:"button",role:"checkbox","aria-checked":k(L)?"mixed":L,"aria-required":u,"data-state":v(L),"data-disabled":p?"":void 0,disabled:p,value:f},b,{ref:y,onKeyDown:(0,s.K)(e.onKeyDown,(e=>{"Enter"===e.key&&e.preventDefault()})),onClick:(0,s.K)(e.onClick,(e=>{z((e=>!!k(e)||!e)),N&&(C.current=e.isPropagationStopped(),C.current||e.stopPropagation())}))})),N&&(0,a.createElement)(E,{control:_,bubbles:!C.current,name:c,value:f,checked:L,required:u,disabled:p,style:{transform:"translateX(-100%)"}}))})),E=e=>{const{control:t,checked:n,bubbles:r=!0,...c}=e,s=(0,a.useRef)(null),l=(0,i.i)(n),u=(0,d.k)(t);return(0,a.useEffect)((()=>{const e=s.current,t=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(t,"checked").set;if(l!==n&&a){const t=new Event("click",{bubbles:r});e.indeterminate=k(n),a.call(e,!k(n)&&n),e.dispatchEvent(t)}}),[l,n,r]),(0,a.createElement)("input",(0,o.c)({type:"checkbox","aria-hidden":!0,defaultChecked:!k(n)&&n},c,{tabIndex:-1,ref:s,style:{...e.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function k(e){return"indeterminate"===e}function v(e){return k(e)?"indeterminate":e?"checked":"unchecked"}const w=_,y=(0,a.forwardRef)(((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...c}=e,s=b("CheckboxIndicator",n);return(0,a.createElement)(u.s,{present:r||k(s.state)||!0===s.state},(0,a.createElement)(m.K0.span,(0,o.c)({"data-state":v(s.state),"data-disabled":s.disabled?"":void 0},c,{ref:t,style:{pointerEvents:"none",...e.style}})))}));var C=n(93396),N=n(15832),L=n(88496),z=n(32572);const S=(0,L.memo)((({indeterminate:e,label:t,value:n,id:o,onChange:r,required:c,disabled:s,options:l={}})=>{const[i,d]=(0,L.useState)(!1),[u,m]=(0,L.useState)(!1);let p=n;Array.isArray(p)||(p=""===p?[]:[p]),(0,L.useEffect)((()=>{let e=1===Object.keys(l).length&&"true"===Object.keys(l)[0];d(e)}),[]),e&&(n=!0);const f=p;let g=!1;Object.keys(l).length>10&&(g=!0);const h=e=>i?n:f.includes(""+e)||f.includes(parseInt(e)),b=()=>{m(!u)};let _=s&&!Array.isArray(s);return 0===Object.keys(l).length?(0,a.createElement)(a.Fragment,null,(0,C.__)("No options found","complianz-gdpr")):(0,a.createElement)("div",{className:"cmplz-checkbox-group"},Object.entries(l).map((([l,d],m)=>(0,a.createElement)("div",{key:l,className:"cmplz-checkbox-group__item"+(!u&&m>9?" cmplz-hidden":"")},(0,a.createElement)(w,{className:"cmplz-checkbox-group__checkbox",id:o+"_"+l,checked:h(l),"aria-label":t,disabled:_||Array.isArray(s)&&s.includes(l),required:c,onCheckedChange:e=>((e,t)=>{if(i)r(!n);else{const e=f.includes(""+t)||f.includes(parseInt(t))?f.filter((e=>e!==""+t&&e!==parseInt(t))):[...f,t];r(e)}})(0,l)},(0,a.createElement)(y,{className:"cmplz-checkbox-group__indicator"},(0,a.createElement)(N.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"}))),(0,a.createElement)("label",{className:"cmplz-checkbox-group__label",htmlFor:o+"_"+l},d)))),!u&&g&&(0,a.createElement)(z.default,{onClick:()=>b()},(0,C.__)("Show more","complianz-gdpr")),u&&g&&(0,a.createElement)(z.default,{onClick:()=>b()},(0,C.__)("Show less","complianz-gdpr")))}))},81300:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var a=n(51280),o=n(88496),r=n(38912),c=n(93396),s=n(28692);const l=(0,o.memo)((()=>{const{documents:e,downloadUrl:t,deleteDocuments:l,documentsLoaded:i,fetchData:d}=(0,s.default)(),[u,m]=(0,o.useState)(""),[p,f]=(0,o.useState)([]),[g,h]=(0,o.useState)({}),[b,_]=(0,o.useState)(!1),[E,k]=(0,o.useState)(!1),[v,w]=(0,o.useState)(null);(0,o.useEffect)((()=>{n.e(2128).then(n.bind(n,32128)).then((({default:e})=>{w((()=>e))}))}),[]),(0,o.useEffect)((()=>{i||d()}),[i]);const y=async()=>{let n=e.filter((e=>p.includes(e.id)));f([]);const a=async()=>{if(n.length>0){const e=n.shift(),o=t+"/"+e.file;m(!0);try{let t=new XMLHttpRequest;t.responseType="blob",t.open("get",o,!0),t.send(),t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let t=window.URL.createObjectURL(this.response),n=window.document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",e.file),window.document.body.appendChild(n),n.click(),setTimeout((function(){window.URL.revokeObjectURL(t)}),6e4)}},await a()}catch(e){console.error(e),m(!1)}}};await a(),m(!1)},C=e=>(e.sort(((e,t)=>e.file<t.file?-1:e.file>t.file?1:0)),e),N=[{name:(0,a.createElement)(r.default,{options:{true:""},indeterminate:b,value:E,onChange:t=>(t=>{if(t){k(!0);let t=g.currentPage?g.currentPage:1,n=C(e).slice(10*(t-1),10*t);f(n.map((e=>e.id)))}else k(!1),f([]);_(!1)})(t)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,c.__)("Document","complianz-gdpr"),selector:e=>e.file,sortable:!0,grow:5},{name:(0,c.__)("Region","complianz-gdpr"),selector:e=>(0,a.createElement)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}),sortable:!0,grow:2,right:!0},{name:(0,c.__)("Consent","complianz-gdpr"),selector:e=>e.consent,sortable:!0,grow:2,right:!0},{name:(0,c.__)("Date","complianz-gdpr"),selector:e=>e.time,sortable:!0,grow:4,right:!0}];let L=[...e];L=C(L);let z=[];return L.forEach((t=>{let n={...t};n.selectControl=(0,a.createElement)(r.default,{value:p.includes(n.id),options:{true:""},onChange:t=>((t,n)=>{let a=[...p];t?a.includes(n)||(a.push(n),f(a)):(a=[...p.filter((e=>e!==n))],f(a));let o=g.currentPage?g.currentPage:1,r=C(e).slice(10*(o-1),10*o),c=!0,s=!1;r.forEach((e=>{a.includes(e.id)?s=!0:c=!1})),c?(k(!0),_(!1)):s?(k(!1),_(!0)):_(!1)})(!p.includes(n.id),n.id)}),z.push(n)})),(0,a.createElement)(a.Fragment,null,p.length>0&&(0,a.createElement)("div",{className:"cmplz-selected-document"},p.length>1&&(0,c.__)("%s items selected","complianz-gdpr").replace("%s",p.length),1===p.length&&(0,c.__)("1 item selected","complianz-gdpr"),(0,a.createElement)("div",{className:"cmplz-selected-document-controls"},(0,a.createElement)("button",{disabled:u,className:"button button-default cmplz-btn-reset",onClick:()=>y()},(0,c.__)("Download Proof of Consent","complianz-gdpr")),(0,a.createElement)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{f([]),await l(e)})(p)},(0,c.__)("Delete","complianz-gdpr")))),v&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(v,{className:"cmplz-data-table",columns:N,data:z,dense:!0,pagination:!0,paginationPerPage:10,onChangePage:e=>{h({...g,currentPage:e})},paginationState:g,noDataComponent:(0,a.createElement)("div",{className:"cmplz-no-documents"},(0,c.__)("No documents","complianz-gdpr")),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}}})))}))},28692:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var a=n(30809),o=n(61744);const r=(0,a.Su)(((e,t)=>({documentsLoaded:!1,fetching:!1,generating:!1,documents:[],downloadUrl:"",regions:[],fields:[],deleteDocuments:async n=>{let a=t().documents.filter((e=>n.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!n.includes(e.id)))})));let r={};r.documents=a,await o.doAction("delete_proof_of_consent_documents",r).then((e=>e)).catch((e=>{console.error(e)}))},generateProofOfConsent:async()=>{e({generating:!0}),await o.doAction("generate_proof_of_consent",{}).then((e=>e)).catch((e=>{console.error(e)})),await t().fetchData(),e({generating:!1})},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:n,regions:a,download_url:r}=await o.doAction("get_proof_of_consent_documents",{}).then((e=>e)).catch((e=>{console.error(e)}));e((e=>({documentsLoaded:!0,documents:n,regions:a,downloadUrl:r,fetching:!1})))}})))},76860:(e,t,n)=>{n.d(t,{s:()=>s});var a=n(51280),o=n(81034),r=n(40304),c=n(84904);const s=e=>{const{present:t,children:n}=e,s=function(e){const[t,n]=(0,a.useState)(),r=(0,a.useRef)({}),s=(0,a.useRef)(e),i=(0,a.useRef)("none"),d=e?"mounted":"unmounted",[u,m]=function(e,t){return(0,a.useReducer)(((e,n)=>{const a=t[e][n];return null!=a?a:e}),e)}(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,a.useEffect)((()=>{const e=l(r.current);i.current="mounted"===u?e:"none"}),[u]),(0,c.w)((()=>{const t=r.current,n=s.current;if(n!==e){const a=i.current,o=l(t);e?m("MOUNT"):"none"===o||"none"===(null==t?void 0:t.display)?m("UNMOUNT"):m(n&&a!==o?"ANIMATION_OUT":"UNMOUNT"),s.current=e}}),[e,m]),(0,c.w)((()=>{if(t){const e=e=>{const n=l(r.current).includes(e.animationName);e.target===t&&n&&(0,o.flushSync)((()=>m("ANIMATION_END")))},n=e=>{e.target===t&&(i.current=l(r.current))};return t.addEventListener("animationstart",n),t.addEventListener("animationcancel",e),t.addEventListener("animationend",e),()=>{t.removeEventListener("animationstart",n),t.removeEventListener("animationcancel",e),t.removeEventListener("animationend",e)}}m("ANIMATION_END")}),[t,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:(0,a.useCallback)((e=>{e&&(r.current=getComputedStyle(e)),n(e)}),[])}}(t),i="function"==typeof n?n({present:s.isPresent}):a.Children.only(n),d=(0,r.q)(s.ref,i.ref);return"function"==typeof n||s.isPresent?(0,a.cloneElement)(i,{ref:d}):null};function l(e){return(null==e?void 0:e.animationName)||"none"}s.displayName="Presence"},37408:(e,t,n)=>{n.d(t,{i:()=>o});var a=n(51280);function o(e){const t=(0,a.useRef)({value:e,previous:e});return(0,a.useMemo)((()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous)),[e])}}}]);