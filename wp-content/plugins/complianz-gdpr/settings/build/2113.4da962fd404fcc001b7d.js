"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[2113,6231],{2113:(t,e,n)=>{n.r(e),n.d(e,{default:()=>l});var s=n(76231),o=n(86087),i=n(45111),r=n(10790);const l=(0,o.memo)(({type:t,...e})=>{const{goToNextStep:n,goToPrevStep:l,nextStepDisabled:a,prevStepDisabled:c,enablePluginInstallation:p,isInstalling:u,isLoading:g,currentStep:d}=(0,s.useNewOnboardingData)(),[m,w]=(0,o.useState)(s.steps[d].prevButton),[_,h]=(0,o.useState)(s.steps[d].nextButton),[b,f]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{h("plugins"===d?u?s.steps[d].nextButtonThird:p?s.steps[d].nextButtonSecondary:s.steps[d].nextButton:s.steps[d].nextButton)},[d,p,u]),(0,o.useEffect)(()=>{f(g||u||c||a)},[g,u,c,a]),(0,r.jsxs)("div",{className:`cmplz-modal-footer-btn-wrap cmplz-btn-${t}`,children:[(u||g)&&"next"===t&&(0,r.jsx)(i.default,{name:"loading",color:"next"===t?"white":"blue",size:14}),(0,r.jsx)("button",{type:"button",onClick:()=>{"next"===t?n():"prev"===t&&l()},className:"button "+("prev"===t?"button-default":"button-primary"),disabled:b,...e,children:(0,r.jsx)("span",{children:"next"===t?_:m})})]})})},76231:(t,e,n)=>{n.r(e),n.d(e,{steps:()=>r,useNewOnboardingData:()=>c});var s=n(9588),o=n(81621),i=n(27723);const r={welcome:{title:(0,i.__)("Welcome to Complianz","complianz-gdpr"),prevButton:(0,i.__)("No, Thanks","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),prevButtonGoTo:"newsletter",nextButtonGoTo:"terms"},terms:{title:(0,i.__)("Terms and Conditions","complianz-gdpr"),prevButton:(0,i.__)("Dismiss","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),prevButtonGoTo:"newsletter",nextButtonGoTo:"newsletter"},newsletter:{title:(0,i.__)("Get tips and tricks","complianz-gdpr"),prevButton:(0,i.__)("Skip","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),prevButtonGoTo:"plugins",nextButtonGoTo:"plugins"},plugins:{title:(0,i.__)("Install quickly for free","complianz-gdpr"),prevButton:(0,i.__)("Skip","complianz-gdpr"),nextButton:(0,i.__)("Continue","complianz-gdpr"),nextButtonSecondary:(0,i.__)("Install","complianz-gdpr"),nextButtonThird:(0,i.__)("Installing ...","complianz-gdpr"),prevButtonGoTo:"thankYou",nextButtonGoTo:"thankYou"},thankYou:{title:(0,i.__)("You’re almost there...","complianz-gdpr"),nextButton:(0,i.__)("Close","complianz-gdpr"),nextButtonGoTo:!1}},l=[{slug:"complianz-terms-conditions",description:(0,i.__)("Missing Terms & Conditions? Generate now","complianz-gdpr"),status:"not-installed",processing:!1},{slug:"really-simple-ssl",description:(0,i.__)("Really Simple Security? Let’s go","complianz-gdpr"),status:"not-installed",processing:!1}],a=async(t,e,n,o)=>{o(t=>({plugins:t.plugins.map(t=>t.slug===n.slug?{...t,status:"processing"}:t)}));const i={slug:n.slug,plugins:t};try{let t="";if("install_plugin"===e){const o=await s.doAction(e,i);if(!o.request_success)throw new Error("API Error: installing plugin.");const r=o.plugins.find(t=>t.slug===n.slug).status||"not-installed";if("not-installed"===r)throw new Error("Error installing plugin.");t=r}const r=await s.doAction("activate_plugin",i);if(!r.request_success)throw new Error("API Error: installing plugin.");const l=r.plugins.find(t=>t.slug===n.slug).status;if("activated"!==l)throw new Error("Error activating plugin.");t=l,o(e=>({plugins:e.plugins.map(e=>e.slug===n.slug?{...e,status:t}:e)}))}catch(t){o({isInstalling:!1}),console.error("Plugin installation error:",t)}},c=(0,o.vt)((t,e)=>({isModalOpen:!0,isOnboardingComplete:!1,currentStep:"welcome",stepProcessing:!1,isLoading:!1,isContentLoading:!0,setIsContentLoading:e=>t({isContentLoading:e}),nextStepDisabled:!1,prevStepDisabled:!1,wscEmail:"",enableWsc:!1,emailError:"",termsAccepted:!1,wscTerms:"",newsletterAccepted:!1,newsletterEmail:"",newsletterTerms:"",fetchError:!1,fetchErrorMessage:"",fetchDoc:async()=>{t({isLoading:!0,fetchError:!1,fetchErrorMessage:""});const n=e().currentStep;let o="terms"===n?"get_wsc_terms":"get_newsletter_terms";const r=await s.doAction(o);r.request_success||t({fetchError:!0,fetchErrorMessage:(0,i.__)("Something went wrong while downloading the document.","complianz-gdpr")});const l=r.doc;l?"terms"===n?t({wscTerms:l,isLoading:!1}):"newsletter"===n&&t({newsletterTerms:l,isLoading:!1}):t({fetchError:!0,fetchErrorMessage:(0,i.__)("Something went wrong while downloading the document.","complianz-gdpr"),isLoading:!1})},suggestedPlugins:l,plugins:[],fetchPlugins:async()=>{try{const e=await s.doAction("get_recommended_plugins_status",{plugins:l});if(!e.request_success)throw new Error("Error fetching.");const n=e.plugins.map(t=>({...t,checked:"activated"===t.status||!1,toProcess:!1}));t({plugins:n})}catch(t){throw new Error("Api error:",t)}},enablePluginInstallation:!1,isInstalling:!1,setWscEmail:e=>t({wscEmail:e}),setEnableWsc:e=>t({enableWsc:e}),setEmailError:e=>t({emailError:e}),setNewsletterEmail:e=>t({newsletterEmail:e}),setNextStepDisabled:e=>t({nextStepDisabled:e}),setPrevStepDisabled:e=>t({prevStepDisabled:e}),setPlugins:e=>t({plugins:e}),setEnablePluginInstallation:e=>t({enablePluginInstallation:e}),closeModal:async n=>{n&&e().skipStep("onboarding");const s=new URL(window.location.href);s.searchParams.delete("websitescan"),window.history.pushState({},"",s.href),t({isModalOpen:!1})},skipStep:async t=>{if(!(await s.doAction("dismiss_wsc_onboarding",{step:t})).request_success)throw new Error("Error fetching.")},goToPrevStep:()=>t(t=>{const n="welcome"===t.currentStep?"newsletter":r[t.currentStep].prevButtonGoTo;if("newsletter"===n||"plugins"===n){const t="newsletter"===n?"websitescan":"newsletter";e().skipStep(t)}return{...t,currentStep:n,stepProcessing:!1}}),goToNextStep:()=>t(async n=>{let o=r[n.currentStep].nextButtonGoTo;t({stepProcessing:!0});try{switch(n.currentStep){case"welcome":0===n.wscEmail.length?(t({enableWsc:!1}),o="newsletter"):t({enableWsc:!0});break;case"terms":let i=e().wscEmail;if(t({termsAccepted:!0,newsletterEmail:i,isLoading:!0}),!(await s.doAction("signup_wsc",{email:i,timestamp:(new Date).getTime(),url:window.location.href})).request_success)throw new Error("Error fetching.");t({isLoading:!1});break;case"newsletter":let r=e().newsletterEmail;if(t({newsletterAccepted:!0,isLoading:!0}),!(await s.doAction("signup_newsletter",{email:r,timestamp:(new Date).getTime(),url:window.location.href})).request_success)throw new Error("Error fetching.");t({isLoading:!1});break;case"plugins":if(!e().enablePluginInstallation)break;const l=e().plugins.filter(t=>t.toProcess);if(l.length<=0)break;const c=e().suggestedPlugins;t({isInstalling:!0});for(const e of l)"not-installed"===e.status?await a(c,"install_plugin",e,t):"installed"===e.status&&await a(c,"activate_plugin",e,t);return void t({isInstalling:!1,stepProcessing:!1,enablePluginInstallation:!1});case"thankYou":t({isOnboardingComplete:!0}),e().closeModal()}t({currentStep:o,stepProcessing:!1})}catch(e){console.error("Error during step transition:",e),t({stepProcessing:!1})}}),isValidEmail:t=>0===t.length||/^[\w.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)}))}}]);