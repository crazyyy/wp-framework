"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[54,3078,8985,9091,9758],{40054:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var n=r(81621),o=r(9588);const a=(0,n.vt)((e,t)=>({recordsLoaded:!1,fetching:!1,generating:!1,progress:!1,records:[],exportLink:"",downloadUrl:"",regions:[],fields:[],noData:!1,totalRecords:0,searchValue:"",setSearchValue:t=>e({searchValue:t}),paginationPerPage:10,pagination:{currentPage:1},setPagination:t=>e({pagination:t}),orderBy:"ID",setOrderBy:t=>e({orderBy:t}),order:"DESC",setOrder:t=>e({order:t}),deleteRecords:async r=>{let n=t().records.filter(e=>r.includes(e.id));e(e=>({records:e.records.filter(e=>!r.includes(e.id))}));let a={};a.records=n,await o.doAction("delete_records_of_consent",a).then(e=>e).catch(e=>{console.error(e)})},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});let r={};r.per_page=t().paginationPerPage,r.page=t().pagination.currentPage,r.order=t().order.toUpperCase(),r.orderBy=t().orderBy,r.search=t().searchValue;const{records:n,totalRecords:a,regions:s,download_url:c}=await o.doAction("get_records_of_consent",r).then(e=>e).catch(e=>{console.error(e)});e(()=>({recordsLoaded:!0,records:n,regions:s,totalRecords:a,downloadUrl:c,fetching:!1}))},startExport:async()=>{e({generating:!0,progress:0,exportLink:""})},fetchExportRecordsOfConsentProgress:async(t,r,n)=>{(t=void 0!==t&&t)||e({generating:!0});let a={};a.startDate=r,a.endDate=n,a.statusOnly=t;const{progress:s,exportLink:c,noData:i}=await o.doAction("export_records_of_consent",a).then(e=>e).catch(e=>{console.error(e)});let l=!1;s<100&&(l=!0),e({progress:s,exportLink:c,generating:l,noData:i})}}))},79758:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r(86087),o=r(9588),a=r(4219),s=r(52043),c=r(56427),i=r(99091),l=r(32828),d=r(10790);const u=(0,n.memo)(({type:e="action",style:t="tertiary",label:r,onClick:u,href:p="",target:g="",disabled:m,action:h,field:f,children:_})=>{if(!r&&!_)return null;const b=(f&&f.button_text?f.button_text:r)||_,{fetchFieldsData:C,showSavedSettingsNotice:k}=(0,a.default)(),{setInitialLoadCompleted:x,setProgress:v}=(0,i.UseCookieScanData)(),{setProgressLoaded:y}=(0,l.default)(),{selectedSubMenuItem:w}=(0,s.default)(),[j,z]=(0,n.useState)(!1),L=`button cmplz-button button--${t} button-${e}`,P=async e=>{await o.doAction(f.action,{}).then(e=>{e.success&&(C(w),"reset_settings"===e.id&&(x(!1),v(0),y(!1)),k(e.message))})},S=f&&f.warn?f.warn:"";return"action"===e?(0,d.jsxs)(d.Fragment,{children:[c.__experimentalConfirmDialog&&(0,d.jsx)(c.__experimentalConfirmDialog,{isOpen:j,onConfirm:async()=>{z(!1),await P()},onCancel:()=>{z(!1)},children:S}),(0,d.jsx)("button",{className:L,onClick:async t=>{if("action"!==e||!u)return"action"===e&&h?c.__experimentalConfirmDialog?void(f&&f.warn?z(!0):await P()):void await P():void(window.location.href=f.url);u(t)},disabled:m,children:b})]}):"link"===e?(0,d.jsx)("a",{className:L,href:p,target:g,children:b}):void 0})},81366:(e,t,r)=>{r.r(t),r.d(t,{default:()=>I});var n=r(51609),o=r(91071),a=r(62133),s=r(9957),c=r(81351),i=r(85357),l=r(54150),d=r(7971),u=r(12579),p=r(10790),g="Checkbox",[m,h]=(0,a.A)(g),[f,_]=m(g);function b(e){const{__scopeCheckbox:t,checked:r,children:o,defaultChecked:a,disabled:s,form:i,name:l,onCheckedChange:d,required:u,value:m="on",internal_do_not_use_render:h}=e,[_,b]=(0,c.i)({prop:r,defaultProp:a??!1,onChange:d,caller:g}),[C,k]=n.useState(null),[x,v]=n.useState(null),y=n.useRef(!1),w=!C||!!i||!!C.closest("form"),j={checked:_,disabled:s,setChecked:b,control:C,setControl:k,name:l,form:i,value:m,hasConsumerStoppedPropagationRef:y,required:u,defaultChecked:!L(a)&&a,isFormControl:w,bubbleInput:x,setBubbleInput:v};return(0,p.jsx)(f,{scope:t,...j,children:z(h)?h(j):o})}var C="CheckboxTrigger",k=n.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...a},c)=>{const{control:i,value:l,disabled:d,checked:g,required:m,setControl:h,setChecked:f,hasConsumerStoppedPropagationRef:b,isFormControl:k,bubbleInput:x}=_(C,e),v=(0,o.s)(c,h),y=n.useRef(g);return n.useEffect(()=>{const e=i?.form;if(e){const t=()=>f(y.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[i,f]),(0,p.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":L(g)?"mixed":g,"aria-required":m,"data-state":P(g),"data-disabled":d?"":void 0,disabled:d,value:l,...a,ref:v,onKeyDown:(0,s.m)(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,s.m)(r,e=>{f(e=>!!L(e)||!e),x&&k&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})})});k.displayName=C;var x=n.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:o,defaultChecked:a,required:s,disabled:c,value:i,onCheckedChange:l,form:d,...u}=e;return(0,p.jsx)(b,{__scopeCheckbox:r,checked:o,defaultChecked:a,disabled:c,required:s,onCheckedChange:l,name:n,form:d,value:i,internal_do_not_use_render:({isFormControl:e})=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(k,{...u,ref:t,__scopeCheckbox:r}),e&&(0,p.jsx)(j,{__scopeCheckbox:r})]})})});x.displayName=g;var v="CheckboxIndicator",y=n.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...o}=e,a=_(v,r);return(0,p.jsx)(d.C,{present:n||L(a.checked)||!0===a.checked,children:(0,p.jsx)(u.sG.span,{"data-state":P(a.checked),"data-disabled":a.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...e.style}})})});y.displayName=v;var w="CheckboxBubbleInput",j=n.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:a,hasConsumerStoppedPropagationRef:s,checked:c,defaultChecked:d,required:g,disabled:m,name:h,value:f,form:b,bubbleInput:C,setBubbleInput:k}=_(w,e),x=(0,o.s)(r,k),v=(0,i.Z)(c),y=(0,l.X)(a);n.useEffect(()=>{const e=C;if(!e)return;const t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"checked").set,n=!s.current;if(v!==c&&r){const t=new Event("click",{bubbles:n});e.indeterminate=L(c),r.call(e,!L(c)&&c),e.dispatchEvent(t)}},[C,v,c,s]);const j=n.useRef(!L(c)&&c);return(0,p.jsx)(u.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??j.current,required:g,disabled:m,name:h,value:f,form:b,...t,tabIndex:-1,ref:x,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function z(e){return"function"==typeof e}function L(e){return"indeterminate"===e}function P(e){return L(e)?"indeterminate":e?"checked":"unchecked"}j.displayName=w;var S=r(27723),N=r(45111),R=r(86087),D=r(79758);const I=(0,R.memo)(({indeterminate:e,label:t,value:r,id:n,onChange:o,required:a,disabled:s,options:c={}})=>{const[i,l]=(0,R.useState)(!1),[d,u]=(0,R.useState)(!1);let g=r;Array.isArray(g)||(g=""===g?[]:[g]),(0,R.useEffect)(()=>{let e=1===Object.keys(c).length&&"true"===Object.keys(c)[0];l(e)},[]),e&&(r=!0);const m=g;let h=!1;Object.keys(c).length>10&&(h=!0);const f=e=>i?r:m.includes(""+e)||m.includes(parseInt(e)),_=()=>{u(!d)};let b=s&&!Array.isArray(s);return 0===Object.keys(c).length?(0,p.jsx)(p.Fragment,{children:(0,S.__)("No options found","complianz-gdpr")}):(0,p.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(c).map(([c,l],u)=>(0,p.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!d&&u>9?" cmplz-hidden":""),children:[(0,p.jsx)(x,{className:"cmplz-checkbox-group__checkbox",id:n+"_"+c,checked:f(c),"aria-label":t,disabled:b||Array.isArray(s)&&s.includes(c),required:a,onCheckedChange:e=>((e,t)=>{if(i)o(!r);else{const e=m.includes(""+t)||m.includes(parseInt(t))?m.filter(e=>e!==""+t&&e!==parseInt(t)):[...m,t];o(e)}})(0,c),children:(0,p.jsx)(y,{className:"cmplz-checkbox-group__indicator",children:(0,p.jsx)(N.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,p.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:n+"_"+c,children:l})]},c)),!d&&h&&(0,p.jsx)(D.default,{onClick:()=>_(),children:(0,S.__)("Show more","complianz-gdpr")}),d&&h&&(0,p.jsx)(D.default,{onClick:()=>_(),children:(0,S.__)("Show less","complianz-gdpr")})]})})},85357:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(51609);function o(e){const t=n.useRef({value:e,previous:e});return n.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},93078:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r(86087),o=r(27723),a=r(40054),s=r(81366),c=r(10790);const i=(0,n.memo)(()=>{const[e,t]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!1),[d,u]=(0,n.useState)(null),{pagination:p,setPagination:g,paginationPerPage:m,orderBy:h,setOrderBy:f,totalRecords:_,order:b,setOrder:C,searchValue:k,setSearchValue:x,records:v,downloadUrl:y,deleteRecords:w,recordsLoaded:j,fetchData:z}=(0,a.default)(),[L,P]=(0,n.useState)(""),[S,N]=(0,n.useState)([]),R=!cmplz_settings.is_premium,[D,I]=(0,n.useState)(null);(0,n.useEffect)(()=>{r.e(3757).then(r.bind(r,83757)).then(({default:e})=>{I(()=>e)})},[]),(0,n.useEffect)(()=>{!j&&cmplz_settings.is_premium&&z()},[j]);const O=async()=>{let e=v.filter(e=>S.includes(e.id)&&""!==e.poc_url);N([]);const t=async()=>{if(e.length>0){const r=e.shift(),n=y+"/"+r.poc_url;P(!0);try{let e=new XMLHttpRequest;e.responseType="blob",e.open("get",n,!0),e.send(),e.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let e=window.URL.createObjectURL(this.response),t=window.document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",r.filename),window.document.body.appendChild(t),t.click(),setTimeout(function(){window.URL.revokeObjectURL(e)},6e4)}},await t()}catch(e){console.error(e),P(!1)}}};await t(),P(!1)},E=((0,o.__)("Opt-in","complianz-gdpr"),(0,o.__)("Opt-out","complianz-gdpr"),(0,o.__)("Other","complianz-gdpr"),e=>(e=e.sort((e,t)=>e.file<t.file?-1:e.file>t.file?1:0)).filter(e=>e.ip.toLowerCase().includes(k.toLowerCase())||e.services.toLowerCase().includes(k.toLowerCase())||e.id.toLowerCase().includes(k.toLowerCase()))),A=[{name:(0,c.jsx)(s.default,{options:{true:""},indeterminate:e,value:i,onChange:e=>(e=>{if(e){l(!0);let e=p.currentPage?p.currentPage:1,t=E(v).slice((e-1)*m,e*m);N(t.map(e=>e.id))}else l(!1),N([]);t(!1)})(e)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,o.__)("User ID","complianz-gdpr"),selector:e=>e.id,sortable:!0,grow:3},{name:(0,o.__)("IP Address","complianz-gdpr"),selector:e=>e.ip,sortable:!0,grow:4},{name:(0,o.__)("Region","complianz-gdpr"),selector:e=>""!==e.region?(0,c.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}):(0,o.__)("Other","complianz-gdpr"),sortable:!0,grow:2},{name:(0,o.__)("Services","complianz-gdpr"),selector:e=>e.services,sortable:!0,grow:5},{name:(0,o.__)("Categories","complianz-gdpr"),selector:e=>(e=>{let t={do_not_track:(0,o.__)("DNT/GPC","complianz-gdpr"),no_choice:(0,o.__)("No Choice","complianz-gdpr"),no_warning:(0,o.__)("No Warning","complianz-gdpr"),functional:(0,o.__)("Functional","complianz-gdpr"),preferences:(0,o.__)("Preferences","complianz-gdpr"),statistics:(0,o.__)("Statistics","complianz-gdpr"),marketing:(0,o.__)("Marketing","complianz-gdpr")},r=[];return Object.keys(t).forEach(n=>{1===parseInt(e[n])&&r.push(t[n])}),r.join(", ")})(e),sortable:!0,grow:7},{name:(0,o.__)("Date","complianz-gdpr"),selector:e=>e.time,sortable:!0,grow:4,minWidth:"200px",right:!0}];let F=[...v];F=E(F);let q=[];return F.forEach(e=>{let r={...e};r.selectControl=(0,c.jsx)(s.default,{value:S.includes(r.id),options:{true:""},onChange:e=>((e,r)=>{let n=[...S];e?n.includes(r)||(n.push(r),N(n)):(n=[...S.filter(e=>e!==r)],N(n));let o=p.currentPage?p.currentPage:1,a=E(v).slice((o-1)*m,o*m),s=!0,c=!1;a.forEach(e=>{n.includes(e.id)?c=!0:s=!1}),s?(l(!0),t(!1)):c?(l(!1),t(!0)):t(!1)})(e,r.id)}),q.push(r)}),(0,c.jsxs)(c.Fragment,{children:[R&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:"cmplz-settings-overlay",children:(0,c.jsx)("div",{className:"cmplz-settings-overlay-message"})})}),(0,c.jsx)("div",{className:"cmplz-table-header",children:(0,c.jsx)("div",{className:"cmplz-table-header-controls",children:(0,c.jsx)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,o.__)("Search","complianz-gdpr"),value:k,onChange:e=>(e=>{clearTimeout(d),x(e);const t=setTimeout(()=>{z(m,1,h,b)},500);u(t)})(e.target.value)})})}),S.length>0&&(0,c.jsxs)("div",{className:"cmplz-selected-document",children:[S.length>1&&(0,o.__)("%s items selected","complianz-gdpr").replace("%s",S.length),1===S.length&&(0,o.__)("1 item selected","complianz-gdpr"),(0,c.jsxs)("div",{className:"cmplz-selected-document-controls",children:[v.filter(e=>S.includes(e.id)&&""!==e.poc_url).length>0&&(0,c.jsx)("button",{disabled:L,className:"button button-default cmplz-btn-reset",onClick:()=>O(),children:(0,o.__)("Download Proof of Consent","complianz-gdpr")}),(0,c.jsx)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{N([]),await w(e)})(S),children:(0,o.__)("Delete","complianz-gdpr")})]})]}),!R&&D&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(D,{columns:A,data:q,dense:!0,pagination:!0,paginationTotalRows:_,paginationServer:!0,noDataComponent:(0,c.jsx)("div",{className:"cmplz-no-documents",children:(0,o.__)("No records","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:m,onChangePage:e=>{g({...p,currentPage:e}),z()},paginationState:p,sortServer:!0,onSort:async(e,t)=>{f(e.orderId),C(t),z()}})})]})})},99091:(e,t,r)=>{r.r(t),r.d(t,{UseCookieScanData:()=>a});var n=r(81621),o=r(9588);const a=(0,n.vt)((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e(e=>({lastLoadedIframe:t})),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then(t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t)))}))}}]);