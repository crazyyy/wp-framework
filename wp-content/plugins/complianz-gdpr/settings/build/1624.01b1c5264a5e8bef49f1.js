"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[622,1624,8985,9091,9758],{61624:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var a=r(86087),o=r(27723),n=r(90622),s=r(81366),c=r(10790);const l=(0,a.memo)(()=>{const[e,t]=(0,a.useState)(!1),[l,d]=(0,a.useState)(null),{records:i,searchValue:u,setSearchValue:p,deleteRecords:g,recordsLoaded:h,fetchData:m,status:f,setStatus:b,resolveRecords:_,totalRecords:x,fetching:k,paginationPerPage:v,pagination:C,setPagination:y,orderBy:j,setOrderBy:P,order:w,setOrder:z,selectedRecords:I,setSelectedRecords:D,setIndeterminate:S,indeterminate:R}=(0,n.default)(),[L,N]=(0,a.useState)(null);(0,a.useEffect)(()=>{r.e(3757).then(r.bind(r,83757)).then(({default:e})=>{N(()=>e)})},[]),(0,a.useEffect)(()=>{h||m(v,1,j,w)},[h]);const E=[{name:(0,c.jsx)(s.default,{options:{true:""},indeterminate:R,value:e,onChange:e=>(e=>{if(e){t(!0);let e=C.currentPage?C.currentPage:1,r=i.slice((e-1)*v,e*v);D(r.map(e=>e.ID))}else t(!1),D([]);S(!1)})(e)}),selector:e=>e.selectControl,orderId:"select",grow:1},{name:(0,o.__)("Email","complianz-gdpr"),selector:e=>e.email,sortable:!0,orderId:"email",grow:3},{name:(0,o.__)("Status","complianz-gdpr"),selector:e=>1==e.resolved?(0,o.__)("Resolved","complianz-gdpr"):(0,o.__)("Open","complianz-gdpr"),sortable:!0,orderId:"resolved",grow:1},{name:(0,o.__)("Region","complianz-gdpr"),selector:e=>e.region?(0,c.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}):"",sortable:!0,grow:1},{name:(0,o.__)("Date","complianz-gdpr"),selector:e=>e.request_date,sortable:!0,grow:3},{name:(0,o.__)("Data Request","complianz-gdpr"),selector:e=>e.type?(0,c.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://complianz.io/"+e.type.slug,children:e.type.short}):"",sortable:!0,orderId:"resolved",right:!0,grow:3}];let O=[...i],q=[];return O.forEach(e=>{let r={...e};r.selectControl=(0,c.jsx)(s.default,{disabled:k,value:I.includes(r.ID),options:{true:""},onChange:e=>((e,r)=>{let a=[...I];e?a.includes(r)||(a.push(r),D(a)):(a=[...I.filter(e=>e!==r)],D(a));let o=C.currentPage?C.currentPage:1,n=i.slice((o-1)*v,o*v),s=!0,c=!1;n.forEach(e=>{a.includes(e.ID)?c=!0:s=!1}),s?(t(!0),S(!1)):c?(t(!1),S(!0)):S(!1)})(e,r.ID)}),q.push(r)}),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"cmplz-table-header",children:(0,c.jsxs)("div",{className:"cmplz-table-header-controls",children:[(0,c.jsxs)("select",{value:f,onChange:e=>(e=>{b(e),setTimeout(()=>{m(v,1,j,w)},500)})(e.target.value),children:[(0,c.jsx)("option",{value:"all",children:(0,o.__)("All","complianz-gdpr")}),(0,c.jsx)("option",{value:"open",children:(0,o.__)("Open","complianz-gdpr")}),(0,c.jsx)("option",{value:"resolved",children:(0,o.__)("Resolved","complianz-gdpr")})]}),(0,c.jsx)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,o.__)("Search","complianz-gdpr"),value:u,onChange:e=>(e=>{clearTimeout(l),p(e);const t=setTimeout(()=>{m(v,1,j,w)},500);d(t)})(e.target.value)})]})}),I.length>0&&(0,c.jsxs)("div",{className:"cmplz-selected-document",children:[I.length>1&&(0,o.__)("%s items selected","complianz-gdpr").replace("%s",I.length),1===I.length&&(0,o.__)("1 item selected","complianz-gdpr"),(0,c.jsxs)("div",{className:"cmplz-selected-document-controls",children:[i.filter(e=>I.includes(e.ID)&&1!=e.resolved).length>0&&(0,c.jsx)("button",{disabled:k,className:"button button-default",onClick:()=>_(I),children:(0,o.__)("Mark as resolved","complianz-gdpr")}),(0,c.jsx)("button",{disabled:k,className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{D([]),await g(e)})(I),children:(0,o.__)("Delete","complianz-gdpr")})]})]}),L&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(L,{columns:E,data:q,dense:!0,pagination:!0,paginationServer:!0,noDataComponent:(0,c.jsx)("div",{className:"cmplz-no-documents",children:(0,o.__)("No records","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:v,onChangePage:e=>{y({...C,currentPage:e}),m()},paginationState:C,paginationTotalRows:x,onChangeRowsPerPage:async(e,t)=>{y({...C,currentPage:t}),m(e,t,j,w)},onSort:async(e,t)=>{P(e.orderId),z(t),m()},sortServer:!0})})]})})},79758:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var a=r(86087),o=r(9588),n=r(4219),s=r(52043),c=r(56427),l=r(99091),d=r(32828),i=r(10790);const u=(0,a.memo)(({type:e="action",style:t="tertiary",label:r,onClick:u,href:p="",target:g="",disabled:h,action:m,field:f,children:b})=>{if(!r&&!b)return null;const _=(f&&f.button_text?f.button_text:r)||b,{fetchFieldsData:x,showSavedSettingsNotice:k}=(0,n.default)(),{setInitialLoadCompleted:v,setProgress:C}=(0,l.UseCookieScanData)(),{setProgressLoaded:y}=(0,d.default)(),{selectedSubMenuItem:j}=(0,s.default)(),[P,w]=(0,a.useState)(!1),z=`button cmplz-button button--${t} button-${e}`,I=async e=>{await o.doAction(f.action,{}).then(e=>{e.success&&(x(j),"reset_settings"===e.id&&(v(!1),C(0),y(!1)),k(e.message))})},D=f&&f.warn?f.warn:"";return"action"===e?(0,i.jsxs)(i.Fragment,{children:[c.__experimentalConfirmDialog&&(0,i.jsx)(c.__experimentalConfirmDialog,{isOpen:P,onConfirm:async()=>{w(!1),await I()},onCancel:()=>{w(!1)},children:D}),(0,i.jsx)("button",{className:z,onClick:async t=>{if("action"!==e||!u)return"action"===e&&m?c.__experimentalConfirmDialog?void(f&&f.warn?w(!0):await I()):void await I():void(window.location.href=f.url);u(t)},disabled:h,children:_})]}):"link"===e?(0,i.jsx)("a",{className:z,href:p,target:g,children:_}):void 0})},81366:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var a=r(51609),o=r(91071),n=r(62133),s=r(9957),c=r(81351),l=r(85357),d=r(54150),i=r(7971),u=r(12579),p=r(10790),g="Checkbox",[h,m]=(0,n.A)(g),[f,b]=h(g);function _(e){const{__scopeCheckbox:t,checked:r,children:o,defaultChecked:n,disabled:s,form:l,name:d,onCheckedChange:i,required:u,value:h="on",internal_do_not_use_render:m}=e,[b,_]=(0,c.i)({prop:r,defaultProp:n??!1,onChange:i,caller:g}),[x,k]=a.useState(null),[v,C]=a.useState(null),y=a.useRef(!1),j=!x||!!l||!!x.closest("form"),P={checked:b,disabled:s,setChecked:_,control:x,setControl:k,name:d,form:l,value:h,hasConsumerStoppedPropagationRef:y,required:u,defaultChecked:!z(n)&&n,isFormControl:j,bubbleInput:v,setBubbleInput:C};return(0,p.jsx)(f,{scope:t,...P,children:w(m)?m(P):o})}var x="CheckboxTrigger",k=a.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},c)=>{const{control:l,value:d,disabled:i,checked:g,required:h,setControl:m,setChecked:f,hasConsumerStoppedPropagationRef:_,isFormControl:k,bubbleInput:v}=b(x,e),C=(0,o.s)(c,m),y=a.useRef(g);return a.useEffect(()=>{const e=l?.form;if(e){const t=()=>f(y.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[l,f]),(0,p.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":z(g)?"mixed":g,"aria-required":h,"data-state":I(g),"data-disabled":i?"":void 0,disabled:i,value:d,...n,ref:C,onKeyDown:(0,s.m)(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,s.m)(r,e=>{f(e=>!!z(e)||!e),v&&k&&(_.current=e.isPropagationStopped(),_.current||e.stopPropagation())})})});k.displayName=x;var v=a.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:a,checked:o,defaultChecked:n,required:s,disabled:c,value:l,onCheckedChange:d,form:i,...u}=e;return(0,p.jsx)(_,{__scopeCheckbox:r,checked:o,defaultChecked:n,disabled:c,required:s,onCheckedChange:d,name:a,form:i,value:l,internal_do_not_use_render:({isFormControl:e})=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(k,{...u,ref:t,__scopeCheckbox:r}),e&&(0,p.jsx)(P,{__scopeCheckbox:r})]})})});v.displayName=g;var C="CheckboxIndicator",y=a.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:a,...o}=e,n=b(C,r);return(0,p.jsx)(i.C,{present:a||z(n.checked)||!0===n.checked,children:(0,p.jsx)(u.sG.span,{"data-state":I(n.checked),"data-disabled":n.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...e.style}})})});y.displayName=C;var j="CheckboxBubbleInput",P=a.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:s,checked:c,defaultChecked:i,required:g,disabled:h,name:m,value:f,form:_,bubbleInput:x,setBubbleInput:k}=b(j,e),v=(0,o.s)(r,k),C=(0,l.Z)(c),y=(0,d.X)(n);a.useEffect(()=>{const e=x;if(!e)return;const t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"checked").set,a=!s.current;if(C!==c&&r){const t=new Event("click",{bubbles:a});e.indeterminate=z(c),r.call(e,!z(c)&&c),e.dispatchEvent(t)}},[x,C,c,s]);const P=a.useRef(!z(c)&&c);return(0,p.jsx)(u.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??P.current,required:g,disabled:h,name:m,value:f,form:_,...t,tabIndex:-1,ref:v,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function w(e){return"function"==typeof e}function z(e){return"indeterminate"===e}function I(e){return z(e)?"indeterminate":e?"checked":"unchecked"}P.displayName=j;var D=r(27723),S=r(45111),R=r(86087),L=r(79758);const N=(0,R.memo)(({indeterminate:e,label:t,value:r,id:a,onChange:o,required:n,disabled:s,options:c={}})=>{const[l,d]=(0,R.useState)(!1),[i,u]=(0,R.useState)(!1);let g=r;Array.isArray(g)||(g=""===g?[]:[g]),(0,R.useEffect)(()=>{let e=1===Object.keys(c).length&&"true"===Object.keys(c)[0];d(e)},[]),e&&(r=!0);const h=g;let m=!1;Object.keys(c).length>10&&(m=!0);const f=e=>l?r:h.includes(""+e)||h.includes(parseInt(e)),b=()=>{u(!i)};let _=s&&!Array.isArray(s);return 0===Object.keys(c).length?(0,p.jsx)(p.Fragment,{children:(0,D.__)("No options found","complianz-gdpr")}):(0,p.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(c).map(([c,d],u)=>(0,p.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!i&&u>9?" cmplz-hidden":""),children:[(0,p.jsx)(v,{className:"cmplz-checkbox-group__checkbox",id:a+"_"+c,checked:f(c),"aria-label":t,disabled:_||Array.isArray(s)&&s.includes(c),required:n,onCheckedChange:e=>((e,t)=>{if(l)o(!r);else{const e=h.includes(""+t)||h.includes(parseInt(t))?h.filter(e=>e!==""+t&&e!==parseInt(t)):[...h,t];o(e)}})(0,c),children:(0,p.jsx)(y,{className:"cmplz-checkbox-group__indicator",children:(0,p.jsx)(S.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,p.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:a+"_"+c,children:d})]},c)),!i&&m&&(0,p.jsx)(L.default,{onClick:()=>b(),children:(0,D.__)("Show more","complianz-gdpr")}),i&&m&&(0,p.jsx)(L.default,{onClick:()=>b(),children:(0,D.__)("Show less","complianz-gdpr")})]})})},85357:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(51609);function o(e){const t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},90622:(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var a=r(81621),o=r(9588),n=r(16535);r(86087);const s=(0,a.vt)((e,t)=>({recordsLoaded:!1,searchValue:"",setSearchValue:t=>e({searchValue:t}),status:"open",setStatus:t=>e({status:t}),selectedRecords:[],setSelectedRecords:t=>e({selectedRecords:t}),fetching:!1,generating:!1,progress:!1,records:[],totalRecords:0,totalOpen:0,exportLink:"",noData:!1,indeterminate:!1,setIndeterminate:t=>e({indeterminate:t}),paginationPerPage:10,pagination:{currentPage:1},setPagination:t=>e({pagination:t}),orderBy:"ID",setOrderBy:t=>e({orderBy:t}),order:"DESC",setOrder:t=>e({order:t}),deleteRecords:async r=>{let a={};a.per_page=t().paginationPerPage,a.page=t().pagination.currentPage,a.order=t().order.toUpperCase(),a.orderBy=t().orderBy,a.search=t().searchValue,a.status=t().status;let n=t().records.filter(e=>r.includes(e.ID));e(e=>({records:e.records.filter(e=>!r.includes(e.ID))})),a.records=n,await o.doAction("delete_datarequests",a).then(e=>e).catch(e=>{console.error(e)}),await t().fetchData(),t().setSelectedRecords([]),t().setIndeterminate(!1)},resolveRecords:async r=>{let a={};a.per_page=t().paginationPerPage,a.page=t().pagination.currentPage,a.order=t().order.toUpperCase(),a.orderBy=t().orderBy,a.search=t().searchValue,a.status=t().status,e((0,n.Ay)(e=>{e.records.forEach(function(t,a){r.includes(t.ID)&&(e.records[a].resolved=!0)})})),a.records=t().records.filter(e=>r.includes(e.ID)),await o.doAction("resolve_datarequests",a).then(e=>e).catch(e=>{console.error(e)}),await t().fetchData(),t().setSelectedRecords([]),t().setIndeterminate(!1)},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});let r={};r.per_page=t().paginationPerPage,r.page=t().pagination.currentPage,r.order=t().order.toUpperCase(),r.orderBy=t().orderBy,r.search=t().searchValue,r.status=t().status;const{records:a,totalRecords:n,totalOpen:s}=await o.doAction("get_datarequests",r).then(e=>e).catch(e=>{console.error(e)});e(()=>({recordsLoaded:!0,records:a,totalRecords:n,totalOpen:s,fetching:!1}))},startExport:async()=>{e({generating:!0,progress:0,exportLink:""})},fetchExportDatarequestsProgress:async(t,r,a)=>{(t=void 0!==t&&t)||e({generating:!0});let n={};n.startDate=r,n.endDate=a,n.statusOnly=t;const{progress:s,exportLink:c,noData:l}=await o.doAction("export_datarequests",n).then(e=>e).catch(e=>{console.error(e)});let d=!1;s<100&&(d=!0),e({progress:s,exportLink:c,generating:d,noData:l})}}))},99091:(e,t,r)=>{r.r(t),r.d(t,{UseCookieScanData:()=>n});var a=r(81621),o=r(9588);const n=(0,a.vt)((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e(e=>({lastLoadedIframe:t})),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then(t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t)))}))}}]);