"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[1629,3068,8985,9091,9758],{13068:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var a=n(81629),o=n(86087),s=n(27723),r=n(45111),i=n(81366),c=n(10790);const l=(0,o.memo)(()=>{const{documents:e,documentsLoaded:t,fetchData:l,deleteDocuments:d,editDocument:u}=(0,a.default)(),[m,p]=(0,o.useState)(""),[h,g]=(0,o.useState)({}),[f,b]=(0,o.useState)(!1),[_,C]=(0,o.useState)(!1),[k,x]=(0,o.useState)(""),[v,w]=(0,o.useState)([]),[y,j]=(0,o.useState)(!1),[z,L]=(0,o.useState)(null);(0,o.useEffect)(()=>{n.e(3757).then(n.bind(n,83757)).then(({default:e})=>{L(()=>e)})},[]),cmplz_settings.is_premium,(0,o.useEffect)(()=>{t||l()},[t]);const N=async()=>{let t=e.filter(e=>v.includes(e.id));j(!0);const n=async()=>{if(t.length>0){const e=t.shift(),a=e.download_url;x(!0);try{let o=new XMLHttpRequest;o.responseType="blob",o.open("get",a,!0),o.send(),o.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let n=window.URL.createObjectURL(this.response),a=window.document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",e.title),window.document.body.appendChild(a),a.click(),w(t),j(!1),setTimeout(function(){window.URL.revokeObjectURL(n)},6e4)}},await n()}catch(e){console.error(e),x(!1)}}};await n(),x(!1)},S=e=>((e=e.filter(e=>e.title.toLowerCase().includes(m.toLowerCase())||e.service.toLowerCase().includes(m.toLowerCase()))).sort((e,t)=>e.title<t.title?-1:e.title>t.title?1:0),e),D=[{name:(0,c.jsx)(i.default,{options:{true:""},indeterminate:f,value:_,onChange:t=>(t=>{if(t){C(!0);let t=h.currentPage?h.currentPage:1,n=S(e).slice(5*(t-1),5*t);w(n.map(e=>e.id))}else C(!1),w([]);b(!1)})(t)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,s.__)("Document","complianz-gdpr"),selector:e=>e.title,sortable:!0,grow:6},{name:(0,s.__)("Region","complianz-gdpr"),selector:e=>(0,c.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}),sortable:!0,grow:2,right:!0},{name:(0,s.__)("Date","complianz-gdpr"),selector:e=>e.date,sortable:!0,grow:4,minWidth:"200px",right:!0}];let I=S(e),P=[];return I.forEach(t=>{let n={...t};n.selectControl=(0,c.jsx)(i.default,{value:v.includes(n.id),options:{true:""},onChange:t=>((t,n)=>{let a=t,o=[...v];a?o.includes(n)||(o.push(n),w(o)):(o=[...v.filter(e=>e!==n)],w(o));let s=h.currentPage?h.currentPage:1,r=S(e).slice(5*(s-1),5*s),i=!0,c=!1;r.forEach(e=>{o.includes(e.id)?c=!0:i=!1}),i?(C(!0),b(!1)):c?(C(!1),b(!0)):b(!1)})(t,n.id)}),P.push(n)}),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"cmplz-table-header",children:(0,c.jsx)("div",{className:"cmplz-table-header-controls",children:(0,c.jsx)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,s.__)("Search","complianz-gdpr"),value:m,onChange:e=>p(e.target.value)})})}),v.length>0&&(0,c.jsxs)("div",{className:"cmplz-selected-document",children:[v.length>1&&(0,s.__)("%s items selected","complianz-gdpr").replace("%s",v.length),1===v.length&&(0,s.__)("1 item selected","complianz-gdpr"),(0,c.jsxs)("div",{className:"cmplz-selected-document-controls",children:[(0,c.jsx)("button",{disabled:k||v.length>1,className:"button button-default",onClick:e=>u(v[0]),children:(0,s.__)("Edit","complianz-gdpr")}),(0,c.jsxs)("button",{disabled:k,className:"button button-default cmplz-btn-reset",onClick:()=>N(),children:[(0,s.__)("Download Processing Agreement","complianz-gdpr"),y&&(0,c.jsx)(r.default,{name:"loading",color:"grey"})]}),(0,c.jsx)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{w([]),await d(e)})(v),children:(0,s.__)("Delete","complianz-gdpr")})]})]}),z&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(z,{columns:D,data:P,dense:!0,pagination:!0,noDataComponent:(0,c.jsx)("div",{className:"cmplz-no-documents",children:(0,s.__)("No documents","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:5,onChangePage:e=>{g({...h,currentPage:e})},paginationState:h})})]})})},79758:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var a=n(86087),o=n(9588),s=n(4219),r=n(52043),i=n(56427),c=n(99091),l=n(32828),d=n(10790);const u=(0,a.memo)(({type:e="action",style:t="tertiary",label:n,onClick:u,href:m="",target:p="",disabled:h,action:g,field:f,children:b})=>{if(!n&&!b)return null;const _=(f&&f.button_text?f.button_text:n)||b,{fetchFieldsData:C,showSavedSettingsNotice:k}=(0,s.default)(),{setInitialLoadCompleted:x,setProgress:v}=(0,c.UseCookieScanData)(),{setProgressLoaded:w}=(0,l.default)(),{selectedSubMenuItem:y}=(0,r.default)(),[j,z]=(0,a.useState)(!1),L=`button cmplz-button button--${t} button-${e}`,N=async e=>{await o.doAction(f.action,{}).then(e=>{e.success&&(C(y),"reset_settings"===e.id&&(x(!1),v(0),w(!1)),k(e.message))})},S=f&&f.warn?f.warn:"";return"action"===e?(0,d.jsxs)(d.Fragment,{children:[i.__experimentalConfirmDialog&&(0,d.jsx)(i.__experimentalConfirmDialog,{isOpen:j,onConfirm:async()=>{z(!1),await N()},onCancel:()=>{z(!1)},children:S}),(0,d.jsx)("button",{className:L,onClick:async t=>{if("action"!==e||!u)return"action"===e&&g?i.__experimentalConfirmDialog?void(f&&f.warn?z(!0):await N()):void await N():void(window.location.href=f.url);u(t)},disabled:h,children:_})]}):"link"===e?(0,d.jsx)("a",{className:L,href:m,target:p,children:_}):void 0})},81366:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var a=n(51609),o=n(91071),s=n(62133),r=n(9957),i=n(81351),c=n(85357),l=n(54150),d=n(7971),u=n(12579),m=n(10790),p="Checkbox",[h,g]=(0,s.A)(p),[f,b]=h(p);function _(e){const{__scopeCheckbox:t,checked:n,children:o,defaultChecked:s,disabled:r,form:c,name:l,onCheckedChange:d,required:u,value:h="on",internal_do_not_use_render:g}=e,[b,_]=(0,i.i)({prop:n,defaultProp:s??!1,onChange:d,caller:p}),[C,k]=a.useState(null),[x,v]=a.useState(null),w=a.useRef(!1),y=!C||!!c||!!C.closest("form"),j={checked:b,disabled:r,setChecked:_,control:C,setControl:k,name:l,form:c,value:h,hasConsumerStoppedPropagationRef:w,required:u,defaultChecked:!L(s)&&s,isFormControl:y,bubbleInput:x,setBubbleInput:v};return(0,m.jsx)(f,{scope:t,...j,children:z(g)?g(j):o})}var C="CheckboxTrigger",k=a.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...s},i)=>{const{control:c,value:l,disabled:d,checked:p,required:h,setControl:g,setChecked:f,hasConsumerStoppedPropagationRef:_,isFormControl:k,bubbleInput:x}=b(C,e),v=(0,o.s)(i,g),w=a.useRef(p);return a.useEffect(()=>{const e=c?.form;if(e){const t=()=>f(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[c,f]),(0,m.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":L(p)?"mixed":p,"aria-required":h,"data-state":N(p),"data-disabled":d?"":void 0,disabled:d,value:l,...s,ref:v,onKeyDown:(0,r.m)(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,r.m)(n,e=>{f(e=>!!L(e)||!e),x&&k&&(_.current=e.isPropagationStopped(),_.current||e.stopPropagation())})})});k.displayName=C;var x=a.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:a,checked:o,defaultChecked:s,required:r,disabled:i,value:c,onCheckedChange:l,form:d,...u}=e;return(0,m.jsx)(_,{__scopeCheckbox:n,checked:o,defaultChecked:s,disabled:i,required:r,onCheckedChange:l,name:a,form:d,value:c,internal_do_not_use_render:({isFormControl:e})=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(k,{...u,ref:t,__scopeCheckbox:n}),e&&(0,m.jsx)(j,{__scopeCheckbox:n})]})})});x.displayName=p;var v="CheckboxIndicator",w=a.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:a,...o}=e,s=b(v,n);return(0,m.jsx)(d.C,{present:a||L(s.checked)||!0===s.checked,children:(0,m.jsx)(u.sG.span,{"data-state":N(s.checked),"data-disabled":s.disabled?"":void 0,...o,ref:t,style:{pointerEvents:"none",...e.style}})})});w.displayName=v;var y="CheckboxBubbleInput",j=a.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:s,hasConsumerStoppedPropagationRef:r,checked:i,defaultChecked:d,required:p,disabled:h,name:g,value:f,form:_,bubbleInput:C,setBubbleInput:k}=b(y,e),x=(0,o.s)(n,k),v=(0,c.Z)(i),w=(0,l.X)(s);a.useEffect(()=>{const e=C;if(!e)return;const t=window.HTMLInputElement.prototype,n=Object.getOwnPropertyDescriptor(t,"checked").set,a=!r.current;if(v!==i&&n){const t=new Event("click",{bubbles:a});e.indeterminate=L(i),n.call(e,!L(i)&&i),e.dispatchEvent(t)}},[C,v,i,r]);const j=a.useRef(!L(i)&&i);return(0,m.jsx)(u.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??j.current,required:p,disabled:h,name:g,value:f,form:_,...t,tabIndex:-1,ref:x,style:{...t.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function z(e){return"function"==typeof e}function L(e){return"indeterminate"===e}function N(e){return L(e)?"indeterminate":e?"checked":"unchecked"}j.displayName=y;var S=n(27723),D=n(45111),I=n(86087),P=n(79758);const R=(0,I.memo)(({indeterminate:e,label:t,value:n,id:a,onChange:o,required:s,disabled:r,options:i={}})=>{const[c,l]=(0,I.useState)(!1),[d,u]=(0,I.useState)(!1);let p=n;Array.isArray(p)||(p=""===p?[]:[p]),(0,I.useEffect)(()=>{let e=1===Object.keys(i).length&&"true"===Object.keys(i)[0];l(e)},[]),e&&(n=!0);const h=p;let g=!1;Object.keys(i).length>10&&(g=!0);const f=e=>c?n:h.includes(""+e)||h.includes(parseInt(e)),b=()=>{u(!d)};let _=r&&!Array.isArray(r);return 0===Object.keys(i).length?(0,m.jsx)(m.Fragment,{children:(0,S.__)("No options found","complianz-gdpr")}):(0,m.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(i).map(([i,l],u)=>(0,m.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!d&&u>9?" cmplz-hidden":""),children:[(0,m.jsx)(x,{className:"cmplz-checkbox-group__checkbox",id:a+"_"+i,checked:f(i),"aria-label":t,disabled:_||Array.isArray(r)&&r.includes(i),required:s,onCheckedChange:e=>((e,t)=>{if(c)o(!n);else{const e=h.includes(""+t)||h.includes(parseInt(t))?h.filter(e=>e!==""+t&&e!==parseInt(t)):[...h,t];o(e)}})(0,i),children:(0,m.jsx)(w,{className:"cmplz-checkbox-group__indicator",children:(0,m.jsx)(D.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,m.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:a+"_"+i,children:l})]},i)),!d&&g&&(0,m.jsx)(P.default,{onClick:()=>b(),children:(0,S.__)("Show more","complianz-gdpr")}),d&&g&&(0,m.jsx)(P.default,{onClick:()=>b(),children:(0,S.__)("Show less","complianz-gdpr")})]})})},81629:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var a=n(81621),o=n(16535),s=n(9588),r=n(73710);const i=(0,a.vt)((e,t)=>({documentsLoaded:!1,region:"",fileName:"",serviceName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:"",serviceName:""})},editDocument:async t=>{e({updating:!0}),await s.doAction("load_processing_agreement",{id:t}).then(t=>{e({fields:t.fields,region:t.region,serviceName:t.serviceName,updating:!1,fileName:t.file_name})}).catch(e=>{console.error(e)}),e({editDocumentId:t})},setRegion:t=>{e({region:t})},setServiceName:t=>{e({serviceName:t})},updateField:(n,a)=>{let s=!1,i=!1;e((0,o.Ay)(e=>{e.fields.forEach(function(e,t){e.id===n&&(i=t,s=!0)}),!1!==i&&(e.fields[i].value=a)}));let c=(0,r.updateFieldsListWithConditions)(t().fields);e({fields:c})},save:async(n,a)=>{e({updating:!0});let o=t().editDocumentId;await s.doAction("save_processing_agreement",{fields:t().fields,region:n,serviceName:a,post_id:o}).then(t=>(e({updating:!1}),t)).catch(e=>{console.error(e)}),t().fetchData()},deleteDocuments:async n=>{let a=t().documents.filter(e=>n.includes(e.id));e(e=>({documents:e.documents.filter(e=>!n.includes(e.id))}));let o={};o.documents=a,await s.doAction("delete_processing_agreement",o).then(e=>e).catch(e=>{console.error(e)})},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:n,regions:a}=await s.doAction("get_processing_agreements",{}).then(e=>e).catch(e=>{console.error(e)});e(()=>({documentsLoaded:!0,documents:n,regions:a,fetching:!1}))},fetchFields:async t=>{let n={region:t};e({loadingFields:!0});const{fields:a}=await s.doAction("get_processing_agreement_fields",n).then(e=>e).catch(e=>{console.error(e)});let o=(0,r.updateFieldsListWithConditions)(a);e(e=>({fields:o,loadingFields:!1}))}}))},85357:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(51609);function o(e){const t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},99091:(e,t,n)=>{n.r(t),n.d(t,{UseCookieScanData:()=>s});var a=n(81621),o=n(9588);const s=(0,a.vt)((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e(e=>({lastLoadedIframe:t})),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then(t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t)))}))}}]);