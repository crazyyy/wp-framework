!function(){"use strict";var t={n:function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,{a:a}),a},d:function(e,a){for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e=jQuery,a=t.n(e),n=lodash,o=wp.i18n,r=rankMathAnalyzer,s={};(0,n.isUndefined)(rankMath.assessor)||(0,n.forEach)(rankMath.assessor.diacritics,(function(t,e){return s[e]=new RegExp(t,"g")}));var i,c=function(t){if((0,n.isUndefined)(t))return t;for(var e in s)t=t.replace(s[e],e);return t};function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}(i=a())((function(){var t=i(".rank-math-tab-nav");function e(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;a=a||"error";var o=i('<div class="notice is-dismissible rank-math-tool-notice"><p></p></div>');o.hide().addClass("notice-"+a).find("p").text(e),t.prev(".notice").remove(),t.before(o),o.slideDown(),i("html,body").animate({scrollTop:o.offset().top-50},"slow"),i(document).trigger("wp-updates-notice-added"),n&&setTimeout((function(){o.fadeOut()}),n)}var a=0,s=rankMath.batchSize,l=!i("#update_all_posts").length||i("#update_all_posts").is(":checked")?rankMath.totalPosts:rankMath.totalPostsWithoutScore,u=l?100/l:0,p=[],h=0;function f(t,e){var d={};return e.addClass("disabled"),i("#update_all_scores").prop("disabled",!0),"complete"===t?(i(".progress-bar span").css("width","100%"),i(".count span.update-posts-done").text(l),void i(".rank-math-modal-footer").removeClass("hidden")):new Promise((function(e){(0,n.forEach)(t,(function(t,e){if(-1===p.indexOf(e)){var a=c(t.keyword);p.push(e);var o=new r.ResultManager,s=wp.i18n,i=new r.Paper("",{locale:rankMath.localeFull});i.setTitle(t.title),i.setDescription(t.description),i.setText(t.content),i.setKeyword(a),i.setKeywords(t.keywords),i.setPermalink(t.url),i.setUrl(c(t.url)),t.thumbnail&&(i.setThumbnail(t.thumbnail),i.setThumbnailAltText(t.thumbnailAlt)),i.setContentAI(t.hasContentAi);var l=function(t){var e=rankMath.assessor.researchesTests;return e=(0,n.difference)(e,["keywordNotUsed"]),t.isProduct?e=(0,n.difference)(e,["keywordInSubheadings","linksHasExternals","linksNotAllExternals","linksHasInternal","titleSentiment","titleHasNumber","contentHasTOC"]):e}(t);new r.Analyzer({i18n:s,analysis:l}).analyzeSome(l,i).then((function(a){o.update(i.getKeyword(),a,!0);var n=o.getScore(i.getKeyword());t.isProduct&&(n=t.isReviewEnabled?n+1:n,n=t.hasProductSchema?n+1:n),d[e]=n}))}})),e()})).then((function(){i.ajax({url:rankMath.api.root+"rankmath/v1/updateSeoScore",method:"POST",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",rankMath.restNonce)},data:{action:"rank_math_update_seo_score",postScores:d},success:function(t){if(1==t)if(h+=s,a+=u*s,i(".progress-bar span").css("width",a+"%"),i(".count span.update-posts-done").text(h),h>=l)i(".progress-bar span").css("width","100%"),i(".count span.update-posts-done").text(l),i(".rank-math-modal-footer").removeClass("hidden");else{var n=e.data("args")||{};n.offset=h,e.data("args",n),m(e)}},error:function(t){i(".rank-math-modal-footer").removeClass("hidden").find("p").text((0,o.__)("Something went wrong. Please refresh the page and try again.","rank-math"))}})}))}function m(t){var a=t.data("action"),n=t.data("args");i.ajax({url:rankMath.api.root+"rankmath/v1/toolsAction",method:"POST",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",rankMath.restNonce)},data:{action:a,args:n}}).always((function(){t.removeAttr("disabled")})).fail((function(t){t&&(t.responseJSON&&t.responseJSON.message?e(t.responseJSON.message):e(t.statusText))})).done((function(n){if(n){if("update_seo_score"===a)return void f(n,t);if("string"==typeof n)return void e(n,"success",!1);if("object"===d(n)&&n.status&&n.message)return void e(n.message,n.status,!1)}e((0,o.__)("Something went wrong. Please try again later.","rank-math"))}))}i(".tools-action").on("click",(function(t){t.preventDefault();var e=i(this);return e.data("confirm")&&!confirm(e.data("confirm"))||(e.attr("disabled","disabled"),"update_seo_score"===e.data("action")&&i(".rank-math-modal-update-score").addClass("show"),m(e)),!1})),i(".rank-math-modal .rank-math-modal-close").on("click",(function(){if(void 0!==rankMath.startUpdateScore&&rankMath.startUpdateScore)return window.close(),!0;i(this).closest(".rank-math-modal").css("display","none")})),void 0!==rankMath.startUpdateScore&&rankMath.startUpdateScore&&i('.tools-action[data-action="update_seo_score"]').trigger("click");var k=i("tr.update_seo_score");if(k.length){var v=(0,o.__)("Include posts/pages where the score is already set","rank-math");rankMath.totalPostsWithoutScore>0&&k.find("td").append('<div class="update_all_scores"><label><input type="checkbox" name="update_all_scores" id="update_all_scores" value="1" checked="checked" /> '.concat(v,"</label></div>")),i("#update_all_scores").on("change",(function(){var t=i(this),e=k.find("a.button"),a=e.data("args")||{};a.update_all_scores=t.is(":checked")?1:0,e.data("args",a),l=t.is(":checked")?rankMath.totalPosts:rankMath.totalPostsWithoutScore,u=100/l,i(".count span.update-posts-total").text(l)})).trigger("change")}}))}();