var WP_Optimize_Heartbeat_Agents={},WP_Optimize_Heartbeat=function(){function e(){o(document).on("heartbeat-send",function(e,t){for(var a in WP_Optimize_Heartbeat_Agents){WP_Optimize_Heartbeat_Agents[a].sent||(t[a]=WP_Optimize_Heartbeat_Agents[a].command,WP_Optimize_Heartbeat_Agents[a].sent=!0);var n=((new Date).getTime()-WP_Optimize_Heartbeat_Agents[a].sent_time.getTime())/1e3;n>c&&(WP_Optimize_Heartbeat_Agents[a].sent=!1)}}),o(document).on("heartbeat-tick",function(e,a){if("object"==typeof a.callbacks)for(var n in a.callbacks)if(t(n)){var r=JSON.parse(a.callbacks[n]);"undefined"!=typeof r.result&&0==r.result?wp_optimize.notices.show_notice(r.error_code,r.error_message):WP_Optimize_Heartbeat_Agents[n].callback(r),delete WP_Optimize_Heartbeat_Agents[n]}}),a()&&(_=WP_Optimize_Heartbeat_Fallback())}function t(e){return 0===e.indexOf("wpo-heartbeat-")}function a(){return"undefined"==typeof wp.heartbeat}function n(e,t){var a=e.command===t.command,n=!1===e.sent;return a&&n}function r(e){var t=Object.values(WP_Optimize_Heartbeat_Agents).some(function(t){return n(t,e)});if(t)return null;var a="wpo-heartbeat-"+s();return e.sent=!1,e.sent_time=new Date,WP_Optimize_Heartbeat_Agents[a]=e,a}function i(e){delete WP_Optimize_Heartbeat_Agents[e]}var _,o=jQuery,c=60,s=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};return{setup:e,add_agent:r,cancel_agent:i}},WP_Optimize_Heartbeat_Fallback=function(){function e(n){var r=Object.assign({},a),i={};jQuery(document).trigger("heartbeat-send",i),r.data=i,jQuery.ajax({type:"post",dataType:"json",url:wpo_heartbeat_ajax.ajaxurl,data:r,success:function(e){"undefined"!=typeof e.callbacks&&jQuery(document).trigger("heartbeat-tick",e)}}),t=setTimeout(e,1e3*n,n)}var t,a={data:{},interval:wpo_heartbeat_ajax.interval,_nonce:wpo_heartbeat_ajax.nonce,action:"heartbeat",screen_id:window.pagenow,has_focus:!1};t=setTimeout(e,1e3*a.interval,a.interval)};