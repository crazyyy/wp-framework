!function(m,e,i){e.wp=e.wp||{},e.wp.dev4press=e.wp.dev4press||{},e.wp.dev4press.media=e.wp.dev4press.media||{},e.wp.dev4press.media.image={handler:null,init:function(){wp&&wp.media&&wp.media.frames&&(void 0===wp.media.frames.dev4press&&(wp.media.frames.dev4press={media:{}}),void 0!==wp.media.frames.dev4press&&void 0!==wp.media.frames.dev4press.media.image_frame||(wp.media.frames.dev4press.media.image_frame=wp.media({title:d4plib_media_data.strings.image_title,className:"media-frame d4plib-media-image-frame",frame:"post",multiple:!1,library:{type:"image"},button:{text:d4plib_media_data.strings.image_button}}),wp.media.frames.dev4press.media.image_frame.on("insert",function(){var e=wp.media.frames.dev4press.media.image_frame.state().get("selection").first().toJSON();wp.dev4press.media.image.handler&&wp.dev4press.media.image.handler(e)})))},open:function(e,i){wp.dev4press.media.image.handler=e,wp.media.frames.dev4press.media.image_frame.open(),m(".d4plib-media-image-frame .media-frame-title h1").html(d4plib_media_data.strings.image_title),m(".d4plib-media-image-frame .media-frame-toolbar .media-toolbar-primary .media-button-insert").html(d4plib_media_data.strings.image_button),i&&m(".d4plib-media-image-frame").addClass("hide-menu")}},e.wp.dev4press.media.control={active_element:null,init:function(){wp.dev4press.media.image.init(),wp.dev4press.media.control.image(),wp.dev4press.media.control.images()},image:function(){m(i).on("click",".d4plib-image-preview",function(e){e.preventDefault(),m(this).parent().find("img").slideToggle(function(){m(this).is(":visible")&&m(this).css("display","block")})}),m(i).on("click",".d4plib-image-remove",function(e){e.preventDefault(),confirm(d4plib_media_data.strings.are_you_sure)&&(m(this).parent().find(".d4plib-image").val("0"),m(this).parent().find("img").attr("src","").hide(),m(this).parent().find(".d4plib-image-name").html(d4plib_media_data.strings.image_not_selected),m(this).parent().find(".d4plib-image-preview, .d4plib-image-remove").hide())}),m(i).on("click",".d4plib-image-add",function(e){e.preventDefault(),wp.dev4press.media.control.active_element=m(this).parent(),wp.dev4press.media.image.open(wp.dev4press.media.control.handlers.image,!0)})},images:function(){m(i).on("click",".d4plib-images-preview",function(e){e.preventDefault(),m(this).parent().find("img").slideToggle(function(){m(this).is(":visible")&&m(this).css("display","block")})}),m(i).on("click",".d4plib-images-remove",function(e){e.preventDefault(),confirm(d4plib_media_data.strings.are_you_sure)&&(1===m(this).parent().parent().find(".d4plib-images-image").length&&m(this).parent().parent().find(".d4plib-images-none").show(),m(this).parent().remove())}),m(i).on("click",".d4plib-images-add",function(e){e.preventDefault(),wp.dev4press.media.control.active_element=m(this).parent(),wp.dev4press.media.image.open(wp.dev4press.media.control.handlers.images,!0)})},handlers:{image:function(e){var i=wp.dev4press.media.control.active_element;m(".d4plib-image",i).val(e.id),m(".d4plib-image-name",i).html("("+e.id+") "+e.name),m("img",i).attr("src",e.url).hide(),m(".d4plib-image-preview, .d4plib-image-remove",i).show()},images:function(e){var i=wp.dev4press.media.control.active_element,a=m(i).find(".d4plib-selected-image").data("name"),d=m("<div class='d4plib-images-image'>");d.append("<input type='hidden' value='"+e.id+"' name='"+a+"[]' />"),d.append("<a class='button d4plib-button-action d4plib-images-remove' aria-label='"+d4plib_media_data.strings.image_remove+"'>"+d4plib_media_data.icons.remove+"</a>"),d.append("<a class='button d4plib-button-action d4plib-images-preview' aria-label='"+d4plib_media_data.strings.image_preview+"'>"+d4plib_media_data.icons.preview+"</a>"),d.append("<span class='d4plib-image-name'>("+e.id+") "+e.name+"</span>"),d.append("<img src='"+e.url+"' />"),m(".d4plib-selected-image",i).append(d),m(".d4plib-images-none",i).hide()}}},m(i).ready(function(){wp.dev4press.media.control.init()})}(jQuery,window,document);