!function(a,s,e){s.wp=s.wp||{},s.wp.sweeppress=s.wp.sweeppress||{},s.wp.sweeppress.helpers={sizeFormat:function(e){if(0===e)return"0 B";var s=Math.floor(Math.log(e)/Math.log(1024));return"<strong>"+(e/Math.pow(1024,s)).toFixed(0)+"</strong> "+" KMGTP".charAt(s)+"B"}},s.wp.sweeppress.admin={init:function(){"dashboard"===d4plib_admin_data.page.panel&&(wp.sweeppress.admin.shared.init(),wp.sweeppress.admin.dashboard.dialogs(),wp.sweeppress.admin.dashboard.init()),"sweep"===d4plib_admin_data.page.panel&&(wp.sweeppress.admin.shared.init(),wp.sweeppress.admin.sweep.init())},dashboard:{init:function(){0<a(".sweeppress-sweeper-check").length&&a(".sweeppress-dashboard-check-all").show(),a(e).on("change",".sweeppress-dashboard-check-all",function(){var e=a(this).closest(".sweeper-dashboard-overview"),s=a(this).is(":checked");a(".sweeppress-sweeper-check",e).prop("checked",s).change()}),a(e).on("change",".sweeppress-task-check, .sweeppress-sweeper-check",function(){const e=a(".sweeppress-task-check:checked"),s=e.length;let t=0,p=0;0<s&&e.each(function(){t+=a(this).data("records"),p+=a(this).data("size")}),a(".sweeppress-sweeper-counters strong").html(t),a(".sweeppress-sweeper-counters span").html(wp.sweeppress.helpers.sizeFormat(p)),a(".sweeppress-sweeper-wrapper input[type=submit]").prop("disabled",0===s)}),a(e).on("click","#sweeppress-information-auto .button-secondary",function(e){e.preventDefault(),a(".sweeper-dashboard-auto").hide(),a(".sweeper-dashboard-overview").show()}),a(e).on("click","#sweeppress-information-auto .button-primary",function(e){e.preventDefault(),a("#sweeppress-dialog-dashboard-auto").wpdialog("open")}),a("form#sweeppress-form-quick").on("submit",function(e){e.preventDefault(),"working"!==a(this).data("status")&&(a(this).slideUp("slow").data("status","working"),a(".sweeppress-dashboard-check-all").hide(),a("#sweeppress-results-quick").slideDown("slow"),a(s).scrollTop(0),a(this).ajaxSubmit({dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=sweeppress-run-quick",success:function(e){a("#sweeppress-results-quick").html(e)},error:function(e,s,t){a("#sweeppress-results-quick").html(t)}}))})},auto:function(){var e=a("#sweeppress-information-auto .button-primary").data("nonce");a("#sweeppress-information-auto").remove(),a("#sweeppress-results-auto").slideDown("slow"),a(s).scrollTop(0),a.ajax({dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=sweeppress-run-auto&_wpnonce="+e,success:function(e){a("#sweeppress-results-auto").html(e)},error:function(e,s,t){a("#sweeppress-results-auto").html(t)}})},dialogs:function(){var e=a.extend({},wp.dev4press.dialogs.default_dialog(),{dialogClass:wp.dev4press.dialogs.classes("sweeppress-dialog-hide-x"),buttons:[{id:"sweeppress-dialog-auto-run",class:"sweeppress-dialog-auto-button-run",text:d4plib_admin_data.ui.buttons.start,data:{icon:"ok"},click:function(){a("#sweeppress-dialog-dashboard-auto").wpdialog("close"),wp.sweeppress.admin.dashboard.auto()}},{id:"sweeppress-dialog-auto-cancel",class:"sweeppress-dialog-auto-button-cancel button-has-focus",text:d4plib_admin_data.ui.buttons.cancel,data:{icon:"cancel"},autofocus:!0,click:function(){a("#sweeppress-dialog-dashboard-auto").wpdialog("close")}}]});a("#sweeppress-dialog-dashboard-auto").wpdialog(e),wp.dev4press.dialogs.icons("#sweeppress-dialog-dashboard-auto")}},sweep:{init:function(){a(e).on("click","button.toggle-empty-tasks",function(e){e.preventDefault();const s="true"===a(this).attr("aria-expanded"),t=a(this).closest(".sweeppress-sweepers-wrapper");t.find(".empty-sweeper").toggleClass("show-empty-sweeper"),t.find(".empty-sweeper-category").toggleClass("show-empty-sweeper-category"),s?a(this).attr("aria-expanded","false"):a(this).attr("aria-expanded","true")}),a(e).on("click",".sweeppress-item-wrapper h5 button.toggle-empty",function(e){e.preventDefault();e="true"===a(this).attr("aria-expanded");a(this).closest(".sweeppress-item-wrapper").toggleClass("show-empty-tasks"),e?a(this).attr("aria-expanded","false"):a(this).attr("aria-expanded","true")}),a(e).on("click",".sweeppress-item-wrapper h5 button.toggle-section",function(e){e.preventDefault();e="#"+a(this).attr("aria-controls");"true"===a(this).attr("aria-expanded")?(a(this).attr("aria-expanded","false"),a(e).prop("hidden",!0)):(a(this).attr("aria-expanded","true"),a(e).prop("hidden",!1))}),a(e).on("change",".sweeppress-task-check, .sweeppress-sweeper-check",function(){const e=a(".sweeppress-task-check:checked"),s=e.length;let t=0,p=0;0<s&&e.each(function(){t+=a(this).data("records"),p+=a(this).data("size")}),a(".sweeppress-sweeper-counters .sweeppress-sweep-tasks").html(s),a(".sweeppress-sweeper-counters .sweeppress-sweep-records").html(t),a(".sweeppress-sweeper-counters .sweeppress-sweep-size").html(wp.sweeppress.helpers.sizeFormat(p)),a("#sweeppress-sweep-run").prop("disabled",0===s)}),a("form#sweeppress-form-sweep").on("submit",function(e){e.preventDefault(),"working"!==a(this).data("status")&&(a(this).data("status","working"),a("#sweeppress-results-wrapper").slideDown("slow"),a(".sweeppress-sweepers-wrapper").slideUp("slow",function(){a(this).remove(),a("#sweeppress-sweep-run").remove()}),a(s).scrollTop(0),a(this).ajaxSubmit({dataType:"html",type:"post",timeout:3e5,url:ajaxurl+"?action=sweeppress-run-sweep",success:function(e){a("#sweeppress-results-sweeper").html(e)},error:function(e,s,t){a("#sweeppress-results-sweeper").html(t)}}))})}},shared:{init:function(){a(e).on("change",".sweeppress-sweeper-check",function(){var e=a(this).closest(".sweeppress-item-wrapper"),s=a(this).is(":checked");a(".sweeppress-task-check",e).prop("checked",s).change()})}},storage:{url:""}},a(e).ready(function(){wp.sweeppress.admin.init()})}(jQuery,window,document);