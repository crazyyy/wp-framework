{"version":3,"sources":["selectivizr.js"],"names":["win","patchStyleSheet","cssText","replace","RE_PSEUDO_ELEMENTS","PLACEHOLDER_STRING","RE_SELECTOR_GROUP","m","prefix","selectorText","selectorGroups","split","c","cs","length","selector","normalizeSelectorWhitespace","SPACE_STRING","patches","RE_SELECTOR_PARSE","match","combinator","pseudo","attribute","index","domPatches","push","substring","patch","patchPseudoClass","patchAttribute","className","join","attr","BROKEN_ATTR_IMPLEMENTATIONS","test","createClassName","applyClass","activateEventName","deactivateEventName","slice","isNegated","bracketIndex","indexOf","charAt","e","root","ieVersion","handler","hash","location","hashID","EMPTY_STRING","id","addEvent","toggleElementClass","RE_INPUT_CHECKABLE_TYPES","type","event","propertyName","checked","RE_INPUT_ELEMENTS","tagName","$disabled","enabledWatchers","disabled","RE_PSEUDO_STRUCTURAL","applyPatches","elms","domSelectorText","RE_LIBRARY_INCOMPATIBLE_PSEUDOS","selectorMethod","ex","log","d","dl","elm","cssClasses","f","fl","hasPatch","toggleClass","RegExp","namespace","patchIE6MultipleClasses","ie6PatchID","RE_PATCH_CLASS_NAME_REPLACE","a","charCodeAt","message","console","trim","text","RE_TIDY_TRIM_WHITESPACE","normalizeWhitespace","RE_TIDY_CONSECUTIVE_WHITESPACE","RE_TIDY_TRAILING_WHITESPACE","RE_TIDY_LEADING_WHITESPACE","on","oldClassName","newClassName","parentNode","classList","re","classExists","eventName","eventHandler","attachEvent","getXHRObject","XMLHttpRequest","ActiveXObject","loadStyleSheet","url","xhr","open","send","status","responseText","resolveUrl","contextUrl","ignoreSameOriginPolicy","getProtocol","getProtocolAndHost","baseUrl","contextUrlPath","lastIndexOf","parseStyleSheet","RE_COMMENT","RE_IMPORT","quoteChar","importUrl","quoteChar2","importUrl2","media","RE_ASSET_URL","isBehavior","assetUrl","getStyleSheets","stylesheet","doc","styleSheets","href","init","setInterval","cl","ContentLoaded","fn","done","top","readyState","detachEvent","call","poll","doScroll","setTimeout","createEventObject","frameElement","ieUserAgent","navigator","userAgent","document","documentElement","compatMode","selectorEngines","NW","MooTools","DOMAssistant","Prototype","YAHOO","Sizzle","jQuery","dojo","baseTags","getElementsByTagName","engine","members","member","context","shift","this"],"mappings":"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","file":"selectivizr.js","sourcesContent":["/*\nselectivizr v1.0.3b - (c) Keith Clark, freely distributable under the terms \nof the MIT license.\n\nselectivizr.com\n*/\n/* \n  \nNotes about this source\n-----------------------\n\n * The #DEBUG_START and #DEBUG_END comments are used to mark blocks of code\n   that will be removed prior to building a final release version (using a\n   pre-compression script)\n  \n  \nReferences:\n-----------\n \n * CSS Syntax          : http://www.w3.org/TR/2003/WD-css3-syntax-20030813/#style\n * Selectors           : http://www.w3.org/TR/css3-selectors/#selectors\n * IE Compatability    : http://msdn.microsoft.com/en-us/library/cc351024(VS.85).aspx\n * W3C Selector Tests  : http://www.w3.org/Style/CSS/Test/CSS3/Selectors/current/html/tests/\n \n*/\n\n(function(win) {\n\n\t// Determine IE version and stop execution if browser isn't IE. This\n\t// handles the script being loaded by non IE browsers because the\n\t// developer didn't use conditional comments.\n\tvar ieUserAgent = navigator.userAgent.match(/MSIE (\\d+)/);\n\tif (!ieUserAgent) {\n\t\treturn false;\n\t}\n\n\t// =========================== Init Objects ============================\n\n\tvar doc = document;\n\tvar root = doc.documentElement;\n\tvar xhr = getXHRObject();\n\tvar ieVersion = ieUserAgent[1];\n\n\t// If were not in standards mode, IE is too old / new or we can't create\n\t// an XMLHttpRequest object then we should get out now.\n\tif (doc.compatMode != 'CSS1Compat' || ieVersion<6 || ieVersion>8 || !xhr) {\n\t\treturn;\n\t}\n\t\n\t\n\t// ========================= Common Objects ============================\n\n\t// Compatiable selector engines in order of CSS3 support. Note: '*' is\n\t// a placholder for the object key name. (basically, crude compression)\n\tvar selectorEngines = {\n\t\t\"NW\"\t\t\t\t\t\t\t\t: \"*.Dom.select\",\n\t\t\"MooTools\"\t\t\t\t\t\t\t: \"$$\",\n\t\t\"DOMAssistant\"\t\t\t\t\t\t: \"*.$\", \n\t\t\"Prototype\"\t\t\t\t\t\t\t: \"$$\",\n\t\t\"YAHOO\"\t\t\t\t\t\t\t\t: \"*.util.Selector.query\",\n\t\t\"Sizzle\"\t\t\t\t\t\t\t: \"*\", \n\t\t\"jQuery\"\t\t\t\t\t\t\t: \"*\",\n\t\t\"dojo\"\t\t\t\t\t\t\t\t: \"*.query\"\n\t};\n\n\tvar selectorMethod;\n\tvar enabledWatchers \t\t\t\t\t= [];     // array of :enabled/:disabled elements to poll\n\tvar domPatches\t\t\t\t\t\t\t= [];\n\tvar ie6PatchID \t\t\t\t\t\t\t= 0;      // used to solve ie6's multiple class bug\n\tvar patchIE6MultipleClasses\t\t\t\t= true;   // if true adds class bloat to ie6\n\tvar namespace \t\t\t\t\t\t\t= \"slvzr\";\n\n\t// Stylesheet parsing regexp's\n\tvar RE_COMMENT\t\t\t\t\t\t\t= /(\\/\\*[^*]*\\*+([^\\/][^*]*\\*+)*\\/)\\s*?/g;\n\tvar RE_IMPORT\t\t\t\t\t\t\t= /@import\\s*(?:(?:(?:url\\(\\s*(['\"]?)(.*)\\1)\\s*\\))|(?:(['\"])(.*)\\3))\\s*([^;]*);/g;\n\tvar RE_ASSET_URL \t\t\t\t\t\t= /(behavior\\s*?:\\s*)?\\burl\\(\\s*([\"']?)(?!data:)([^\"')]+)\\2\\s*\\)/g;\n\tvar RE_PSEUDO_STRUCTURAL\t\t\t\t= /^:(empty|(first|last|only|nth(-last)?)-(child|of-type))$/;\n\tvar RE_PSEUDO_ELEMENTS\t\t\t\t\t= /:(:first-(?:line|letter))/g;\n\tvar RE_SELECTOR_GROUP\t\t\t\t\t= /((?:^|(?:\\s*})+)(?:\\s*@media[^{]+{)?)\\s*([^\\{]*?[\\[:][^{]+)/g;\n\tvar RE_SELECTOR_PARSE\t\t\t\t\t= /([ +~>])|(:[a-z-]+(?:\\(.*?\\)+)?)|(\\[.*?\\])/g; \n\tvar RE_LIBRARY_INCOMPATIBLE_PSEUDOS\t\t= /(:not\\()?:(hover|enabled|disabled|focus|checked|target|active|visited|first-line|first-letter)\\)?/g;\n\tvar RE_PATCH_CLASS_NAME_REPLACE\t\t\t= /[^\\w-]/g;\n\t\n\t// HTML UI element regexp's\n\tvar RE_INPUT_ELEMENTS\t\t\t\t\t= /^(INPUT|SELECT|TEXTAREA|BUTTON)$/;\n\tvar RE_INPUT_CHECKABLE_TYPES\t\t\t= /^(checkbox|radio)$/;\n\n\t// Broken attribute selector implementations (IE7/8 native [^=\"\"], [$=\"\"] and [*=\"\"])\n\tvar BROKEN_ATTR_IMPLEMENTATIONS\t\t\t= ieVersion>6 ? /[\\$\\^*]=(['\"])\\1/ : null;\n\n\t// Whitespace normalization regexp's\n\tvar RE_TIDY_TRAILING_WHITESPACE\t\t\t= /([(\\[+~])\\s+/g;\n\tvar RE_TIDY_LEADING_WHITESPACE\t\t\t= /\\s+([)\\]+~])/g;\n\tvar RE_TIDY_CONSECUTIVE_WHITESPACE\t\t= /\\s+/g;\n\tvar RE_TIDY_TRIM_WHITESPACE\t\t\t\t= /^\\s*((?:[\\S\\s]*\\S)?)\\s*$/;\n\t\n\t// String constants\n\tvar EMPTY_STRING\t\t\t\t\t\t= \"\";\n\tvar SPACE_STRING\t\t\t\t\t\t= \" \";\n\tvar PLACEHOLDER_STRING\t\t\t\t\t= \"$1\";\n\n\t// =========================== Patching ================================\n\n\t// --[ patchStyleSheet() ]----------------------------------------------\n\t// Scans the passed cssText for selectors that require emulation and\n\t// creates one or more patches for each matched selector.\n\tfunction patchStyleSheet( cssText ) {\n\t\treturn cssText.replace(RE_PSEUDO_ELEMENTS, PLACEHOLDER_STRING).\n\t\t\treplace(RE_SELECTOR_GROUP, function(m, prefix, selectorText) {\t\n    \t\t\tvar selectorGroups = selectorText.split(\",\");\n    \t\t\tfor (var c = 0, cs = selectorGroups.length; c < cs; c++) {\n    \t\t\t\tvar selector = normalizeSelectorWhitespace(selectorGroups[c]) + SPACE_STRING;\n    \t\t\t\tvar patches = [];\n    \t\t\t\tselectorGroups[c] = selector.replace(RE_SELECTOR_PARSE, \n    \t\t\t\t\tfunction(match, combinator, pseudo, attribute, index) {\n    \t\t\t\t\t\tif (combinator) {\n    \t\t\t\t\t\t\tif (patches.length>0) {\n    \t\t\t\t\t\t\t\tdomPatches.push( { selector: selector.substring(0, index), patches: patches } )\n    \t\t\t\t\t\t\t\tpatches = [];\n    \t\t\t\t\t\t\t}\n    \t\t\t\t\t\t\treturn combinator;\n    \t\t\t\t\t\t}\t\t\n    \t\t\t\t\t\telse {\n    \t\t\t\t\t\t\tvar patch = (pseudo) ? patchPseudoClass( pseudo ) : patchAttribute( attribute );\n    \t\t\t\t\t\t\tif (patch) {\n    \t\t\t\t\t\t\t\tpatches.push(patch);\n    \t\t\t\t\t\t\t\treturn \".\" + patch.className;\n    \t\t\t\t\t\t\t}\n    \t\t\t\t\t\t\treturn match;\n    \t\t\t\t\t\t}\n    \t\t\t\t\t}\n    \t\t\t\t);\n    \t\t\t}\n    \t\t\treturn prefix + selectorGroups.join(\",\");\n    \t\t});\n\t};\n\n\t// --[ patchAttribute() ]-----------------------------------------------\n\t// returns a patch for an attribute selector.\n\tfunction patchAttribute( attr ) {\n\t\treturn (!BROKEN_ATTR_IMPLEMENTATIONS || BROKEN_ATTR_IMPLEMENTATIONS.test(attr)) ? \n\t\t\t{ className: createClassName(attr), applyClass: true } : null;\n\t};\n\n\t// --[ patchPseudoClass() ]---------------------------------------------\n\t// returns a patch for a pseudo-class\n\tfunction patchPseudoClass( pseudo ) {\n\n\t\tvar applyClass = true;\n\t\tvar className = createClassName(pseudo.slice(1));\n\t\tvar isNegated = pseudo.substring(0, 5) == \":not(\";\n\t\tvar activateEventName;\n\t\tvar deactivateEventName;\n\n\t\t// if negated, remove :not() \n\t\tif (isNegated) {\n\t\t\tpseudo = pseudo.slice(5, -1);\n\t\t}\n\t\t\n\t\t// bracket contents are irrelevant - remove them\n\t\tvar bracketIndex = pseudo.indexOf(\"(\")\n\t\tif (bracketIndex > -1) {\n\t\t\tpseudo = pseudo.substring(0, bracketIndex);\n\t\t}\t\t\n\t\t\n\t\t// check we're still dealing with a pseudo-class\n\t\tif (pseudo.charAt(0) == \":\") {\n\t\t\tswitch (pseudo.slice(1)) {\n\n\t\t\t\tcase \"root\":\n\t\t\t\t\tapplyClass = function(e) {\n\t\t\t\t\t\treturn isNegated ? e != root : e == root;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"target\":\n\t\t\t\t\t// :target is only supported in IE8\n\t\t\t\t\tif (ieVersion == 8) {\n\t\t\t\t\t\tapplyClass = function(e) {\n\t\t\t\t\t\t\tvar handler = function() { \n\t\t\t\t\t\t\t\tvar hash = location.hash;\n\t\t\t\t\t\t\t\tvar hashID = hash.slice(1);\n\t\t\t\t\t\t\t\treturn isNegated ? (hash == EMPTY_STRING || e.id != hashID) : (hash != EMPTY_STRING && e.id == hashID);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\taddEvent( win, \"hashchange\", function() {\n\t\t\t\t\t\t\t\ttoggleElementClass(e, className, handler());\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\treturn handler();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t\n\t\t\t\tcase \"checked\":\n\t\t\t\t\tapplyClass = function(e) { \n\t\t\t\t\t\tif (RE_INPUT_CHECKABLE_TYPES.test(e.type)) {\n\t\t\t\t\t\t\taddEvent( e, \"propertychange\", function() {\n\t\t\t\t\t\t\t\tif (event.propertyName == \"checked\") {\n\t\t\t\t\t\t\t\t\ttoggleElementClass( e, className, e.checked !== isNegated );\n\t\t\t\t\t\t\t\t} \t\t\t\t\t\t\t\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn e.checked !== isNegated;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\tcase \"disabled\":\n\t\t\t\t\tisNegated = !isNegated;\n\n\t\t\t\tcase \"enabled\":\n\t\t\t\t\tapplyClass = function(e) { \n\t\t\t\t\t\tif (RE_INPUT_ELEMENTS.test(e.tagName)) {\n\t\t\t\t\t\t\taddEvent( e, \"propertychange\", function() {\n\t\t\t\t\t\t\t\tif (event.propertyName == \"$disabled\") {\n\t\t\t\t\t\t\t\t\ttoggleElementClass( e, className, e.$disabled === isNegated );\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tenabledWatchers.push(e);\n\t\t\t\t\t\t\te.$disabled = e.disabled;\n\t\t\t\t\t\t\treturn e.disabled === isNegated;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn pseudo == \":enabled\" ? isNegated : !isNegated;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\tcase \"focus\":\n\t\t\t\t\tactivateEventName = \"focus\";\n\t\t\t\t\tdeactivateEventName = \"blur\";\n\t\t\t\t\t\t\t\t\n\t\t\t\tcase \"hover\":\n\t\t\t\t\tif (!activateEventName) {\n\t\t\t\t\t\tactivateEventName = \"mouseenter\";\n\t\t\t\t\t\tdeactivateEventName = \"mouseleave\";\n\t\t\t\t\t}\n\t\t\t\t\tapplyClass = function(e) {\n\t\t\t\t\t\taddEvent( e, isNegated ? deactivateEventName : activateEventName, function() {\n\t\t\t\t\t\t\ttoggleElementClass( e, className, true );\n\t\t\t\t\t\t})\n\t\t\t\t\t\taddEvent( e, isNegated ? activateEventName : deactivateEventName, function() {\n\t\t\t\t\t\t\ttoggleElementClass( e, className, false );\n\t\t\t\t\t\t})\n\t\t\t\t\t\treturn isNegated;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t// everything else\n\t\t\t\tdefault:\n\t\t\t\t\t// If we don't support this pseudo-class don't create \n\t\t\t\t\t// a patch for it\n\t\t\t\t\tif (!RE_PSEUDO_STRUCTURAL.test(pseudo)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn { className: className, applyClass: applyClass };\n\t};\n\n\t// --[ applyPatches() ]-------------------------------------------------\n\tfunction applyPatches() {\n\t\tvar elms, selectorText, patches, domSelectorText;\n\n\t\tfor (var c=0; c<domPatches.length; c++) {\n\t\t\tselectorText = domPatches[c].selector;\n\t\t\tpatches = domPatches[c].patches;\n\n\t\t\t// Although some selector libraries can find :checked :enabled etc.\n\t\t\t// we need to find all elements that could have that state because\n\t\t\t// it can be changed by the user.\n\t\t\tdomSelectorText = selectorText.replace(RE_LIBRARY_INCOMPATIBLE_PSEUDOS, EMPTY_STRING);\n\n\t\t\t// If the dom selector equates to an empty string or ends with\n\t\t\t// whitespace then we need to append a universal selector (*) to it.\n\t\t\tif (domSelectorText == EMPTY_STRING || domSelectorText.charAt(domSelectorText.length - 1) == SPACE_STRING) {\n\t\t\t\tdomSelectorText += \"*\";\n\t\t\t}\n\n\t\t\t// Ensure we catch errors from the selector library\n\t\t\ttry {\n\t\t\t\telms = selectorMethod( domSelectorText );\n\t\t\t} catch (ex) {\n\t\t\t\t// #DEBUG_START\n\t\t\t\tlog( \"Selector '\" + selectorText + \"' threw exception '\" + ex + \"'\" );\n\t\t\t\t// #DEBUG_END\n\t\t\t}\n\n\n\t\t\tif (elms) {\n\t\t\t\tfor (var d = 0, dl = elms.length; d < dl; d++) {\n\t\t\t\t\tvar elm = elms[d];\n\t\t\t\t\tvar cssClasses = elm.className;\n\t\t\t\t\tfor (var f = 0, fl = patches.length; f < fl; f++) {\n\t\t\t\t\t\tvar patch = patches[f];\n\t\t\t\t\t\tif (!hasPatch(elm, patch)) {\n\t\t\t\t\t\t\tif (patch.applyClass && (patch.applyClass === true || patch.applyClass(elm) === true)) {\n\t\t\t\t\t\t\t\tcssClasses = toggleClass(cssClasses, patch.className, true );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telm.className = cssClasses;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t// --[ hasPatch() ]-----------------------------------------------------\n\t// checks for the exsistence of a patch on an element\n\tfunction hasPatch( elm, patch ) {\n\t\treturn new RegExp(\"(^|\\\\s)\" + patch.className + \"(\\\\s|$)\").test(elm.className);\n\t};\n\t\n\t\n\t// =========================== Utility =================================\n\t\n\tfunction createClassName( className ) {\n\t\treturn namespace + \"-\" + ((ieVersion == 6 && patchIE6MultipleClasses) ?\n\t\t\tie6PatchID++\n\t\t:\n\t\t\tclassName.replace(RE_PATCH_CLASS_NAME_REPLACE, function(a) { return a.charCodeAt(0) }));\n\t};\n\n\t// --[ log() ]----------------------------------------------------------\n\t// #DEBUG_START\n\tfunction log( message ) {\n\t\tif (win.console) {\n\t\t\twin.console.log(message);\n\t\t}\n\t};\n\t// #DEBUG_END\n\n\t// --[ trim() ]---------------------------------------------------------\n\t// removes leading, trailing whitespace from a string\n\tfunction trim( text ) {\n\t\treturn text.replace(RE_TIDY_TRIM_WHITESPACE, PLACEHOLDER_STRING);\n\t};\n\n\t// --[ normalizeWhitespace() ]------------------------------------------\n\t// removes leading, trailing and consecutive whitespace from a string\n\tfunction normalizeWhitespace( text ) {\n\t\treturn trim(text).replace(RE_TIDY_CONSECUTIVE_WHITESPACE, SPACE_STRING);\n\t};\n\n\t// --[ normalizeSelectorWhitespace() ]----------------------------------\n\t// tidies whitespace around selector brackets and combinators\n\tfunction normalizeSelectorWhitespace( selectorText ) {\n\t\treturn normalizeWhitespace(selectorText.\n\t\t\treplace(RE_TIDY_TRAILING_WHITESPACE, PLACEHOLDER_STRING).\n\t\t\treplace(RE_TIDY_LEADING_WHITESPACE, PLACEHOLDER_STRING)\n\t\t);\n\t};\n\n\t// --[ toggleElementClass() ]-------------------------------------------\n\t// toggles a single className on an element\n\tfunction toggleElementClass( elm, className, on ) {\n\t\tvar oldClassName = elm.className;\n\t\tvar newClassName = toggleClass(oldClassName, className, on);\n\t\tif (newClassName != oldClassName) {\n\t\t\telm.className = newClassName;\n\t\t\telm.parentNode.className += EMPTY_STRING;\n\t\t}\n\t};\n\n\t// --[ toggleClass() ]--------------------------------------------------\n\t// adds / removes a className from a string of classNames. Used to \n\t// manage multiple class changes without forcing a DOM redraw\n\tfunction toggleClass( classList, className, on ) {\n\t\tvar re = RegExp(\"(^|\\\\s)\" + className + \"(\\\\s|$)\");\n\t\tvar classExists = re.test(classList);\n\t\tif (on) {\n\t\t\treturn classExists ? classList : classList + SPACE_STRING + className;\n\t\t} else {\n\t\t\treturn classExists ? trim(classList.replace(re, PLACEHOLDER_STRING)) : classList;\n\t\t}\n\t};\n\t\n\t// --[ addEvent() ]-----------------------------------------------------\n\tfunction addEvent(elm, eventName, eventHandler) {\n\t\telm.attachEvent(\"on\" + eventName, eventHandler);\n\t};\n\n\t// --[ getXHRObject() ]-------------------------------------------------\n\tfunction getXHRObject() {\n\t\tif (win.XMLHttpRequest) {\n\t\t\treturn new XMLHttpRequest;\n\t\t}\n\t\ttry\t{ \n\t\t\treturn new ActiveXObject('Microsoft.XMLHTTP');\n\t\t} catch(e) { \n\t\t\treturn null;\n\t\t}\n\t};\n\n\t// --[ loadStyleSheet() ]-----------------------------------------------\n\tfunction loadStyleSheet( url ) {\n\t\txhr.open(\"GET\", url, false);\n\t\txhr.send();\n\t\treturn (xhr.status==200) ? xhr.responseText : EMPTY_STRING;\t\n\t};\n\t\n\t// --[ resolveUrl() ]---------------------------------------------------\n\t// Converts a URL fragment to a fully qualified URL using the specified\n\t// context URL. Returns null if same-origin policy is broken\n\tfunction resolveUrl( url, contextUrl, ignoreSameOriginPolicy ) {\n\n\t\tfunction getProtocol( url ) {\n\t\t\treturn url.substring(0, url.indexOf(\"//\"));\n\t\t};\n\n\t\tfunction getProtocolAndHost( url ) {\n\t\t\treturn url.substring(0, url.indexOf(\"/\", 8));\n\t\t};\n\n\t\tif (!contextUrl) {\n\t\t\tcontextUrl = baseUrl;\n\t\t}\n\n\t\t// protocol-relative path\n\t\tif (url.substring(0,2)==\"//\") {\n\t\t\turl = getProtocol(contextUrl) + url;\n\t\t}\n\n\t\t// absolute path\n\t\tif (/^https?:\\/\\//i.test(url)) {\n\t\t\treturn !ignoreSameOriginPolicy && getProtocolAndHost(contextUrl) != getProtocolAndHost(url) ? null : url ;\n\t\t}\n\n\t\t// root-relative path\n\t\tif (url.charAt(0)==\"/\")\t{\n\t\t\treturn getProtocolAndHost(contextUrl) + url;\n\t\t}\n\n\t\t// relative path\n\t\tvar contextUrlPath = contextUrl.split(/[?#]/)[0]; // ignore query string in the contextUrl\t\n\t\tif (url.charAt(0) != \"?\" && contextUrlPath.charAt(contextUrlPath.length - 1) != \"/\") {\n\t\t\tcontextUrlPath = contextUrlPath.substring(0, contextUrlPath.lastIndexOf(\"/\") + 1);\n\t\t}\n\n\t\treturn contextUrlPath + url;\n\t};\n\t\n\t// --[ parseStyleSheet() ]----------------------------------------------\n\t// Downloads the stylesheet specified by the URL, removes it's comments\n\t// and recursivly replaces @import rules with their contents, ultimately\n\t// returning the full cssText.\n\tfunction parseStyleSheet( url ) {\n\t\tif (url) {\n\t\t\treturn loadStyleSheet(url).replace(RE_COMMENT, EMPTY_STRING).\n\t\t\treplace(RE_IMPORT, function( match, quoteChar, importUrl, quoteChar2, importUrl2, media ) {\n\t\t\t\tvar cssText = parseStyleSheet(resolveUrl(importUrl || importUrl2, url));\n\t\t\t\treturn (media) ? \"@media \" + media + \" {\" + cssText + \"}\" : cssText;\n\t\t\t}).\n\t\t\treplace(RE_ASSET_URL, function( match, isBehavior, quoteChar, assetUrl ) { \n\t\t\t\tquoteChar = quoteChar || EMPTY_STRING;\n\t\t\t\treturn isBehavior ? match : \" url(\" + quoteChar + resolveUrl(assetUrl, url, true) + quoteChar + \") \"; \n\t\t\t});\n\t\t}\n\t\treturn EMPTY_STRING;\n\t};\n\n\t// --[ getStyleSheets() ]-----------------------------------------------\n\tfunction getStyleSheets() {\n\t\tvar url, stylesheet;\n\t\tfor (var c = 0; c < doc.styleSheets.length; c++) {\n\t\t\tstylesheet = doc.styleSheets[c];\n\t\t\tif (stylesheet.href != EMPTY_STRING) {\n\t\t\t\turl = resolveUrl(stylesheet.href);\n\t\t\t\tif (url) {\n\t\t\t\t\tstylesheet.cssText = stylesheet[\"rawCssText\"] = patchStyleSheet( parseStyleSheet( url ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t// --[ init() ]---------------------------------------------------------\n\tfunction init() {\n\t\tapplyPatches();\n\n\t\t// :enabled & :disabled polling script (since we can't hook \n\t\t// onpropertychange event when an element is disabled) \n\t\tif (enabledWatchers.length > 0) {\n\t\t\tsetInterval( function() {\n\t\t\t\tfor (var c = 0, cl = enabledWatchers.length; c < cl; c++) {\n\t\t\t\t\tvar e = enabledWatchers[c];\n\t\t\t\t\tif (e.disabled !== e.$disabled) {\n\t\t\t\t\t\tif (e.disabled) {\n\t\t\t\t\t\t\te.disabled = false;\n\t\t\t\t\t\t\te.$disabled = true;\n\t\t\t\t\t\t\te.disabled = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\te.$disabled = e.disabled;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 250)\n\t\t}\n\t};\n\n\t// Determine the baseUrl and download the stylesheets\n\tvar baseTags = doc.getElementsByTagName(\"BASE\");\n\tvar baseUrl = (baseTags.length > 0) ? baseTags[0].href : doc.location.href;\n\tgetStyleSheets();\n\n\t// Bind selectivizr to the ContentLoaded event. \n\tContentLoaded(win, function() {\n\t\t// Determine the \"best fit\" selector engine\n\t\tfor (var engine in selectorEngines) {\n\t\t\tvar members, member, context = win;\n\t\t\tif (win[engine]) {\n\t\t\t\tmembers = selectorEngines[engine].replace(\"*\", engine).split(\".\");\n\t\t\t\twhile ((member = members.shift()) && (context = context[member])) {}\n\t\t\t\tif (typeof context == \"function\") {\n\t\t\t\t\tselectorMethod = context;\n\t\t\t\t\tinit();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\t\n\n\t\n\t/*!\n\t * ContentLoaded.js by Diego Perini, modified for IE<9 only (to save space)\n\t *\n\t * Author: Diego Perini (diego.perini at gmail.com)\n\t * Summary: cross-browser wrapper for DOMContentLoaded\n\t * Updated: 20101020\n\t * License: MIT\n\t * Version: 1.2\n\t *\n\t * URL:\n\t * http://javascript.nwbox.com/ContentLoaded/\n\t * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE\n\t *\n\t */\n\n\t// @w window reference\n\t// @f function reference\n\tfunction ContentLoaded(win, fn) {\n\n\t\tvar done = false, top = true,\n\t\tinit = function(e) {\n\t\t\tif (e.type == \"readystatechange\" && doc.readyState != \"complete\") return;\n\t\t\t(e.type == \"load\" ? win : doc).detachEvent(\"on\" + e.type, init, false);\n\t\t\tif (!done && (done = true)) fn.call(win, e.type || e);\n\t\t},\n\t\tpoll = function() {\n\t\t\ttry { root.doScroll(\"left\"); } catch(e) { setTimeout(poll, 50); return; }\n\t\t\tinit('poll');\n\t\t};\n\n\t\tif (doc.readyState == \"complete\") fn.call(win, EMPTY_STRING);\n\t\telse {\n\t\t\tif (doc.createEventObject && root.doScroll) {\n\t\t\t\ttry { top = !win.frameElement; } catch(e) { }\n\t\t\t\tif (top) poll();\n\t\t\t}\n\t\t\taddEvent(doc,\"readystatechange\", init);\n\t\t\taddEvent(win,\"load\", init);\n\t\t}\n\t};\n})(this);"],"sourceRoot":"/source/"}