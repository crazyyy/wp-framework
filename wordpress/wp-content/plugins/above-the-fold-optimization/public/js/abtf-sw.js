!function(n,k,t){function F(a,d,b){caches.open(p).then(function(c){function g(b){b=new Response(b,{status:d.status,statusText:d.statusText,headers:f});c.put(a,b)}var f={};d.headers.forEach(function(a,c){f[c]=a});f["x-abtf-sw"]=l();b&&b.max_age&&(f["x-abtf-sw-expire"]=b.max_age);d.headers.get("content-type").match(/text/i)?d.text().then(g):d.blob().then(g)})}function D(a){a&&("string"==typeof a&&(a=new Request(a,{mode:"no-cors"})),q(a).then(function(d){return d||m(a)}))}function q(a){return caches.open(p).then(function(d){return d.match(a)})}
function w(a){return a=new Request(a),q(a).then(function(d){return d?d.text().then(function(a){return new Response(a,{status:503,statusText:"Connection Offline",headers:d.headers})}):k(a)})}function G(a,d,b,c){var g=b.headers.get("etag"),f=b.headers.get("last-modified");g||f?(b=new Request(a.url,{method:"HEAD",headers:a.headers,mode:"no-cors"}),k(b).then(function(b){var e=!1,C=b.headers.get("etag");b=b.headers.get("last-modified");return(C&&C!==g?e=!0:b&&b!==f&&(e=!0),e)?(e=m(a,d),c&&(e=e.then(c)),
e):null})["catch"](function(){var b=m(a,d);return c&&(b=b.then(c)),b})):(b=m(a,d),c&&(b=b.then(c)))}function m(a,d,b){return k(a).then(function(b){if(b.ok&&400>b.status&&d){var c=!0;d.conditions&&d.conditions.forEach(function(f){if(c)switch(f.type){case "url":f.regex?(e=u(f.pattern))?(g=e.test(a.url),f.not?g&&(c=!1):g||(c=!1)):c=!1:(g=-1!==a.url.indexOf(f.pattern),f.not?g&&(c=!1):g||(c=!1));break;case "header":var d=b.headers.get(f.name);if(d)if(f.regex){var e=u(f.pattern);e?(g=e.test(d),f.not?g&&
(c=!1):g||(c=!1)):c=!1}else if("object"==typeof f.pattern)if(f.pattern.operator)if(d=parseFloat(d),e=parseFloat(f.pattern.value),isNaN(d)||isNaN(e))c=!1;else{switch(f.pattern.operator){case "<":g=d<e;break;case ">":g=d>e;break;case "=":var g=d===e;break;default:c=!1}c&&(f.not?g&&(c=!1):g||(c=!1))}else c=!1;else-1===d.indexOf(f.pattern)&&(c=!1);else c=!1}});c&&F(a,b.clone(),d)}return b})["catch"](function(c){return b?b(a,null,c):null})}function E(){x||(!y||y<l()-10)&&(x=!0,y=l(),caches.keys().then(function(a){return a&&
0!==a.length?Promise.all(a.map(function(a){if(0!==a.indexOf(p))return caches["delete"](a);caches.open(a).then(function(a){a.keys().then(function(c){if(c.length<v)return this;var b=[],f=[],d=[];return c.forEach(function(c){f.push(c);d.push(a.match(c))}),Promise.all(d).then(function(c){var d=l();return c.forEach(function(c,g){if(c&&c.headers){var e=c.headers.get("x-abtf-sw");if(e){var h=c.headers.get("x-abtf-sw-expire");if(h&&e&&e<l()-h)return void a["delete"](f[g])}else e=d;!1!==b&&b.push({t:e,r:f[g]})}}),
b&&b.length>v&&(b.sort(function(a,c){return a.t>c.t?-1:a.t<c.t?1:0}),b.slice(v).forEach(function(c){a["delete"](c.r)})),this})})})})).then(function(){x=!1}):Promise.resolve()}))}function u(a){if(a=a.match(H)){try{var d=new RegExp(a[1],a[2])}catch(b){}return d||!1}}function l(){return Math.round(Date.now()/1E3)}function z(){return k("./abtf-pwa-policy.json",{mode:"no-cors"}).then(function(a){if(a&&a.ok&&400>a.status)return a.json().then(function(a){if(h=a,r=l(),h&&h.length){var b=[];h.forEach(function(a){a.offline&&
-1===b.indexOf(a.offline)&&b.push(a.offline)});b.forEach(function(a){D(a)})}});throw h=!1,Error("cache policy not found: ./abtf-pwa-policy.json");})["catch"](function(a){throw h=!1,a;})}function A(a){return new Promise(function(d,b){if(h&&d(h),!h||!r||a&&a>r){var c=!h;z().then(function(){c&&(h?d(h):b())})["catch"](function(){c&&b()})}else if(r<l()-300){var g=new Request("./abtf-pwa-policy.json",{method:"HEAD",mode:"no-cors"});k(g).then(function(a){a=a.headers.get("last-modified");(!a||a&&a>r)&&z()})}})}
var p,h=!1,r=!1,v=1E3;t.prototype.add||(t.prototype.add=function(a){return this.addAll([a])});t.prototype.addAll||(t.prototype.addAll=function(a){function d(a){this.name="NetworkError";this.code=19;this.message=a}var b=this;return d.prototype=Object.create(Error.prototype),Promise.resolve().then(function(){if(1>arguments.length)throw new TypeError;return a=a.map(function(a){return a instanceof Request?a:String(a)}),Promise.all(a.map(function(a){"string"==typeof a&&(a=new Request(a));var b=(new URL(a.url)).protocol;
if("http:"!==b&&"https:"!==b)throw new d("Invalid scheme");return k(a.clone())}))}).then(function(c){return Promise.all(c.map(function(c,d){return b.put(a[d],c)}))}).then(function(){})});CacheStorage.prototype.match||(CacheStorage.prototype.match=function(a,d){var b=this;return this.keys().then(function(c){var g;return c.reduce(function(c,h){return c.then(function(){return g||b.open(h).then(function(b){return b.match(a,d)}).then(function(a){return g=a})})},Promise.resolve())})});n.addEventListener("install",
function(a){a.waitUntil(z().then(function(){n.skipWaiting()})["catch"](function(){n.skipWaiting()}))});n.addEventListener("activate",function(a){a.waitUntil(n.clients.claim())});var B,H=/^\/(.*)\/([gimuy]+)?$/,y=!1,x=!1;n.addEventListener("fetch",function(a){if("GET"===a.request.method&&!(a.request.url.match(/wp-admin/)||a.request.url.match(/preview=true/)||a.request.url.match(/\/wp-login\./))){if(h&&p)return a.respondWith(A().then(function(d){if(!d||0===d.length)return k(a.request);if(B)try{clearTimeout(B)}catch(c){}B=
setTimeout(E,500);var b=!1;if(d.forEach(function(c){if(!b&&c.match&&0!==c.match.length){var d=!0;c.match.forEach(function(b){if(d)switch(b.type){case "url":b.regex?(c=u(b.pattern))?(e=c.test(a.request.url),b.not?e&&(d=!1):e||(d=!1)):d=!1:(e=-1!==a.request.url.indexOf(b.pattern),b.not?e&&(d=!1):e||(d=!1));break;case "header":if(e=a.request.headers.get(b.name))if(b.regex){var c=u(b.pattern);c?(e=c.test(e),b.not?e&&(d=!1):e||(d=!1)):d=!1}else{var e=-1!==e.indexOf(b.pattern);b.not?e&&(d=!1):e||(d=!1)}else b.not||
(d=!1)}});d&&(b=c)}}),!b)return k(a.request);switch(b.strategy){case "cache":return q(a.request).then(function(c){if(c&&b.cache.max_age&&c.headers.get("x-abtf-sw")<l()-b.cache.max_age&&(c=!1),c){var d=!0,f=b.cache.update_interval?!isNaN(parseInt(b.cache.update_interval))&&parseInt(b.cache.update_interval):!1;if(f){var h=c.headers.get("x-abtf-sw");h&&parseInt(h)>l()-f&&(d=!1)}return d&&function(a,c){setTimeout(function(){var d;if(b.cache.head_update&&(d=function(){clients.matchAll().then(function(b){b.forEach(function(b){b.postMessage([2,
a.url])})})}),b.cache.head_update)G(a,b.cache,c,d);else{var e=m(a,b.cache);d&&e.then(d)}},10)}(a.request.clone(),c.clone()),c}return m(a.request,b.cache,function(c,d){return b.offline?w(b.offline,c.clone()):d||k(a.request.clone())})});case "event":return q(a.request).then(function(c){return c&&b.cache.max_age&&c.headers.get("x-abtf-sw")<l()-b.cache.max_age&&(c=!1),c||m(a.request,null,function(c,d){return b.offline?w(b.offline,c.clone()):d||k(a.request)})});default:return m(a.request,b.cache,function(c,
d){return q(c).then(function(f){return f||(b.offline?w(b.offline,c.clone()):d||k(a.request))})})}}));A()}});n.addEventListener("message",function(a){if(a&&a.data&&a.data instanceof Array){if(1===a.data[0]){a.data[1]&&!isNaN(parseInt(a.data[1]))&&A(parseInt(a.data[1]));a.data[3]&&!isNaN(parseInt(a.data[3]))&&(v=parseInt(a.data[3]));var d="abtf:"+(a.data[2]?a.data[2]+":":"");d!==p&&(p=d);E()}if(2===a.data[0]&&a.data[1]){var b;"string"==typeof a.data[1]||a.data[1]instanceof Request?b=[a.data[1]]:a.data[1]instanceof
Array&&(b=a.data[1]);b&&b.forEach(function(a){D(a)})}}})}(self,self.fetch,Cache);
