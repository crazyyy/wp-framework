Abtf[0](function(O,d){function A(a){var b=L(a);if(b){var c;a:{c=m("css"===b?a.href:a.src).href;var e,f=!1;if(B){var g=C.indexOf(c);if(-1<g)var h=D[g];else if(0<n.length)for(var k,l=n.length,q=0;q<l;q++){g=!1;try{k=new RegExp(n[q][0],n[q][1]||"")}catch(P){g=!0}if(!g&&k.test(c)){f=!0;e=c;n[q][2]?h=n[q][2]:n[q][3]&&(c=n[q][3]);break}}if(h){var p;k=E;void 0!==u[c]?p=u[c]:v&&(p=v);p&&(k=k.replace(/^http(s)?:\/\/[^\/]+\//,p));k+=h.substr(0,2)+"/";k+=h.substr(2,2)+"/";k+=h.substr(4,2)+"/";k+=h;p=!1;if("js"===
b){if(k+=".js",void 0!==d[24])g=m(k).href,(k=d[24](g))!==g&&(p=k)}else"css"===b&&(k+=".css");c=(p?f?console.log("Abtf.proxy()","localStorage regex capture",d[29](e),"\u27a4","cache:"+h,"\u27a4",p):console.log("Abtf.proxy()","localStorage capture",d[29](c),"\u27a4","cache:"+h,"\u27a4",p):f?console.log("Abtf.proxy()","regex capture",d[29](e),"\u27a4","cache:"+h):console.log("Abtf.proxy()","capture",d[29](c),"\u27a4","cache:"+h),k);break a}}if("js"===b&&void 0!==d[24]&&(h=m(c).href,(c=d[24](h))!==h)){c=
(f?console.log("Abtf.proxy()","localStorage regex capture",d[29](e),"regex","\u27a4",d[29](h),"\u27a4",c):console.log("Abtf.proxy()","localStorage capture",d[29](h),"\u27a4",c),c);break a}c=(f?console.log("Abtf.proxy()","capture",d[29](e),"regex","\u27a4",c):console.log("Abtf.proxy()","capture",d[29](c)),F(c,b))}"css"===b?a.href=c:"js"===b&&(a.src=c)}}function L(a){if(a.nodeName)if("SCRIPT"===a.nodeName.toUpperCase()){if(!G||a.hasAttribute("data-abtf"))return!1;if(a.src){b=m(a.src);if(M(b))return!1;
if(!H(b)){if(void 0!==d[24]){if("blob:"===b.protocol)return!1;url=d[24](b.href);url!==b.href?(console.log("Abtf.proxy()","localStorage local capture",d[29](b.href),"\u27a4",url),a.src=url):console.log("Abtf.proxy()","localStorage local capture",d[29](b.href),"\u27a4","bypass cache","\u27a4",url)}return!1}return"js"}}else if("LINK"===a.nodeName.toUpperCase()&&"stylesheet"===a.rel.toLowerCase()){if(!I||a.hasAttribute("data-abtf"))return!1;if(a.href){var b=m(a.href);if(a=!N(b)){a:if(b="object"==typeof b&&
void 0!==b.href?b:m(b),"blob:"===b.protocol)b=!1;else{if(f){a=f.length;for(var c=0;c<a;c++)if(-1!==b.href.indexOf(f[c].href)){b=!1;break a}}b=b.host!==y.host}a=!!b&&"css"}return a}}return!1}function N(a){a="object"==typeof a&&void 0!==a.href?a:m(a);if("blob:"===a.protocol)return!0;if(w){for(var b=!1,c=w.length,e=0;e<c;e++)if(-1!==a.href.indexOf(w[e])){b=!0;break}if(!b)return console.log("Abtf.proxy()","ignore",d[29](a.href),"not on include list"),!0}if(r)for(c=r.length,e=0;e<c;e++)if(-1!==a.href.indexOf(r[e]))return console.log("Abtf.proxy()",
"ignore",d[29](a.href),"on exclude list:",r[e]),!0;return!1}function M(a){a="object"==typeof a&&void 0!==a.href?a:m(a);if("blob:"===a.protocol)return!0;if(x){for(var b=!1,c=x.length,e=0;e<c;e++)if(-1!==a.href.indexOf(x[e])){b=!0;break}if(!b)return console.log("Abtf.proxy()","ignore",d[29](a.href),"not on include list"),!0}if(t)for(c=t.length,e=0;e<c;e++)if(-1!==a.href.indexOf(t[e]))return console.log("Abtf.proxy()","ignore",d[29](a.href),"on exclude list:",t[e]),!0;return!1}function H(a,b){var c=
"object"==typeof a&&void 0!==a.href?a:m(a);if("blob:"===c.protocol)return!1;if(f&&!0!==b)for(var e=f.length,d=0;d<e;d++)if(-1!==c.href.indexOf(f[d].href))return!1;return c.host!==y.host}function F(a,b){return"css"===b?z.replace("{PROXY:URL}",escape(a)).replace("{PROXY:TYPE}",escape(b)):"js"===b?z.replace("{PROXY:URL}",escape(a)).replace("{PROXY:TYPE}",escape(b)):void 0}function m(a){var b=document.createElement("a");return b.href=a,b}var z,E,G=!1,I=!1,v=!1,x=!1,t=!1,w=!1,r=!1,B=!1,C=[],D=[],n=[],
u={},f=[];d[27]=function(a){if(void 0===b)var b=!1;if((z=a[0]&&-1!==a[0]?a[0]:b)||console.error("Abtf.proxy()","no proxy url",a),G=!(!a[1]||-1===a[1])&&a[1],I=!(!a[2]||-1===a[2])&&a[2],(v=!(!a[9]||-1===a[9])&&a[9])&&f.push(v),x=!(!a[5]||-1===a[5])&&a[5],t=!(!a[6]||-1===a[6])&&a[6],w=!(!a[7]||-1===a[7])&&a[7],r=!(!a[8]||-1===a[8])&&a[8],a[3]){B=!0;for(b=0;b<a[3].length;b++)"regex"===a[3][b][0]?(n.push([a[3][b][2],a[3][b][3],a[3][b][1]]),a[3][b][4]&&(u[a[3][b][0]]=a[3][b][4],-1===f.indexOf(a[3][b][4])&&
f.push(a[3][b][4]))):(C.push(a[3][b][0]),D.push(a[3][b][1]),a[3][b][4]&&(u[a[3][b][0]]=a[3][b][4],-1===f.indexOf(a[3][b][4])&&f.push(a[3][b][4])));E=!(!a[4]||-1===a[4])&&a[4]}if(0===f.length)f=!1;else for(a=f.length,b=0;b<a;b++)f[b]=m(f[b])};var l={Element:"undefined"!=typeof Element&&Element,Document:"undefined"!=typeof Document&&Document},J={},K={},g;for(g in l)l.hasOwnProperty(g)&&l[g]&&(J[g]=l[g].prototype.appendChild,K[g]=l[g].prototype.insertBefore);var y=document.createElement("a");y.href=
document.location.href;for(g in l)l.hasOwnProperty(g)&&l[g]&&function(a){l[a].prototype.appendChild=function(b){return A(b),J[a].call(this,b)};l[a].prototype.insertBefore=function(b,c){return A(b),K[a].call(this,b,c)}}(g);d[28]=function(a){return H(a,!0)?F(a,"js"):a}});
