Abtf[0](function(e,r){var o,t,n=!1,f=!1,i=!1,l=!1,c=!1,a=!1,s=!1,u=!1,p=[],h=[],d=[],g={},b=[];r[27]=function(e){if(void 0===r)var r=!1;if((o=e[0]&&-1!==e[0]?e[0]:r)||console.error("Abtf.proxy()","no proxy url",e),n=!(!e[1]||-1===e[1])&&e[1],f=!(!e[2]||-1===e[2])&&e[2],(i=!(!e[9]||-1===e[9])&&e[9])&&b.push(i),l=!(!e[5]||-1===e[5])&&e[5],c=!(!e[6]||-1===e[6])&&e[6],a=!(!e[7]||-1===e[7])&&e[7],s=!(!e[8]||-1===e[8])&&e[8],e[3]){u=!0;for(x=0;x<e[3].length;x++)"regex"===e[3][x][0]?(d.push([e[3][x][2],e[3][x][3],e[3][x][1]]),e[3][x][4]&&(g[e[3][x][0]]=e[3][x][4],-1===b.indexOf(e[3][x][4])&&b.push(e[3][x][4]))):(p.push(e[3][x][0]),h.push(e[3][x][1]),e[3][x][4]&&(g[e[3][x][0]]=e[3][x][4],-1===b.indexOf(e[3][x][4])&&b.push(e[3][x][4])));t=!(!e[4]||-1===e[4])&&e[4]}if(0===b.length)b=!1;else for(var v=b.length,x=0;x<v;x++)b[x]=O(b[x])};var v={Element:"undefined"!=typeof Element&&Element,Document:"undefined"!=typeof Document&&Document},x={append:{},insert:{}};for(var y in v)v.hasOwnProperty(y)&&v[y]&&(x.append[y]=v[y].prototype.appendChild,x.insert[y]=v[y].prototype.insertBefore);var A=document.createElement("a");A.href=document.location.href;var O=function(e){var r=document.createElement("a");return r.href=e,r},m=function(e,r){return"css"===r?o.replace("{PROXY:URL}",escape(e)).replace("{PROXY:TYPE}",escape(r)):"js"===r?o.replace("{PROXY:URL}",escape(e)).replace("{PROXY:TYPE}",escape(r)):void 0},j=function(e,o){var n,f=!1;if(u){var l=p.indexOf(e);if(l>-1)var c=h[l];else if(d.length>0)for(var a,s,b=d.length,v=0;v<b;v++){s=!1;try{a=new RegExp(d[v][0],d[v][1]||"")}catch(e){s=!0}if(!s&&a.test(e)){f=!0,n=e,d[v][2]?c=d[v][2]:d[v][3]&&(e=d[v][3]);break}}if(c){var x,y=t;void 0!==g[e]?x=g[e]:i&&(x=i),x&&(y=y.replace(/^http(s)?:\/\/[^\/]+\//,x)),y+=c.substr(0,2)+"/",y+=c.substr(2,2)+"/",y+=c.substr(4,2)+"/",y+=c;var A=!1;if("js"===o){if(y+=".js",void 0!==r[24]){var j=O(y).href;(y=r[24](j))!==j&&(A=y)}}else"css"===o&&(y+=".css");return A?f?console.log("Abtf.proxy()","localStorage regex capture",r[29](n),"➤","cache:"+c,"➤",A):console.log("Abtf.proxy()","localStorage capture",r[29](e),"➤","cache:"+c,"➤",A):f?console.log("Abtf.proxy()","regex capture",r[29](n),"➤","cache:"+c):console.log("Abtf.proxy()","capture",r[29](e),"➤","cache:"+c),y}}if("js"===o&&void 0!==r[24]){var P=O(e).href;if((e=r[24](P))!==P)return f?console.log("Abtf.proxy()","localStorage regex capture",r[29](n),"regex","➤",r[29](P),"➤",e):console.log("Abtf.proxy()","localStorage capture",r[29](P),"➤",e),e}return f?console.log("Abtf.proxy()","capture",r[29](n),"regex","➤",e):console.log("Abtf.proxy()","capture",r[29](e)),m(e,o)},P=function(e,r){var o="object"==typeof e&&void 0!==e.href?e:O(e);if("blob:"===o.protocol)return!1;if(b&&!0!==r)for(var t=b.length,n=0;n<t;n++)if(-1!==o.href.indexOf(b[n].href))return!1;return o.host!==A.host},C=function(e){var o="object"==typeof e&&void 0!==e.href?e:O(e);if("blob:"===o.protocol)return!0;if(l){for(var t=!1,n=l.length,f=0;f<n;f++)if(-1!==o.href.indexOf(l[f])){t=!0;break}if(!t)return console.log("Abtf.proxy()","ignore",r[29](o.href),"not on include list"),!0}if(c)for(var n=c.length,f=0;f<n;f++)if(-1!==o.href.indexOf(c[f]))return console.log("Abtf.proxy()","ignore",r[29](o.href),"on exclude list:",c[f]),!0;return!1},E=function(e){var r="object"==typeof e&&void 0!==e.href?e:O(e);if("blob:"===r.protocol)return!1;if(b)for(var o=b.length,t=0;t<o;t++)if(-1!==r.href.indexOf(b[t].href))return!1;return r.host!==A.host},R=function(e){var o="object"==typeof e&&void 0!==e.href?e:O(e);if("blob:"===o.protocol)return!0;if(a){for(var t=!1,n=a.length,f=0;f<n;f++)if(-1!==o.href.indexOf(a[f])){t=!0;break}if(!t)return console.log("Abtf.proxy()","ignore",r[29](o.href),"not on include list"),!0}if(s)for(var n=s.length,f=0;f<n;f++)if(-1!==o.href.indexOf(s[f]))return console.log("Abtf.proxy()","ignore",r[29](o.href),"on exclude list:",s[f]),!0;return!1},S=function(e){if(e.nodeName)if("SCRIPT"===e.nodeName.toUpperCase()){if(!n)return!1;if(e.hasAttribute("data-abtf"))return!1;if(e.src){o=O(e.src);if(C(o))return!1;if(!P(o)){if(void 0!==r[24]){if("blob:"===o.protocol)return!1;url=r[24](o.href),url!==o.href?(console.log("Abtf.proxy()","localStorage local capture",r[29](o.href),"➤",url),e.src=url):console.log("Abtf.proxy()","localStorage local capture",r[29](o.href),"➤","bypass cache","➤",url)}return!1}return"js"}}else if("LINK"===e.nodeName.toUpperCase()&&"stylesheet"===e.rel.toLowerCase()){if(!f)return!1;if(e.hasAttribute("data-abtf"))return!1;if(e.href){var o=O(e.href);return!R(o)&&(!!E(o)&&"css")}}return!1},Y=function(e){var r=S(e);if(!r)return!1;var o=O("css"===r?e.href:e.src).href,t=j(o,r);"css"===r?e.href=t:"js"===r&&(e.src=t)},w={appendChild:function(e,r){return Y(r),x.append[e].call(this,r)},insertBefore:function(e,r,o){return Y(r),x.insert[e].call(this,r,o)}};for(var y in v)v.hasOwnProperty(y)&&v[y]&&function(e){v[e].prototype.appendChild=function(r){return w.appendChild.call(this,e,r)},v[e].prototype.insertBefore=function(r,o){return w.insertBefore.call(this,e,r,o)}}(y);r[28]=function(e){return P(e,!0)?m(e,"js"):e}});