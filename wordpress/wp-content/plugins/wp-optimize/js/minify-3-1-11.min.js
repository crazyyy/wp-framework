!function(e){var t=window.wp_optimize||{},i=t.send_command,n=wpoptimize.refresh_frequency||3e4;if(!i)return void console.error("WP-Optimize Minify: wp_optimize.send_command is required.");var s={};s.init=function(){function t(e){return e.data("url")}function n(t){var i=e("#exclude_js"),n=i.val();n+=t+"\n",i.val(n)}function s(t){var i=e("#exclude_css"),n=i.val();n+=t+"\n",i.val(n)}function a(t){e("#wp-optimize-nav-tab-wpo_minify-"+t+"-contents form").data("need_saving",!0)}function o(t){t.closest(".wpo_min_log").prev().removeClass("hidden").addClass("updated").slideDown(),t.text(wpoptimize.add_to_exclusion),t.removeClass("exclude"),t.parent().addClass("disable-list-item"),t.replaceWith(e("<span>"+t.text()+"</span>"))}function c(t){e('input[name="enable_defer_js"]').each(function(t,i){e(i).closest("fieldset").removeClass("selected").find(".defer-js-settings").slideUp("fast")}),e('input[name="enable_defer_js"]:checked').closest("fieldset").addClass("selected").find(".defer-js-settings").slideDown("fast")}var p=this;return this.enabled=!1,e(document).on("wp-optimize/minify/toggle-status",function(t,i){i.hasOwnProperty("enabled")&&(e('[data-whichpage="wpo_minify"]').toggleClass("is-enabled",i.enabled),p.enabled=i.enabled,p.enabled&&p.getFiles())}),e(".purge_minify_cache").on("click",function(t){t.preventDefault(),e.blockUI(),i("purge_minify_cache",null,function(e){p.updateFilesLists(e.files),p.updateStats(e.files)}).always(function(){e.unblockUI()})}),e(".purge_all_minify_cache").on("click",function(){e.blockUI(),i("purge_all_minify_cache",null,function(e){p.updateFilesLists(e.files),p.updateStats(e.files)}).always(function(){e.unblockUI()})}),e(".minify_increment_cache").on("click",function(){e.blockUI(),i("minify_increment_cache",null,function(e){e.hasOwnProperty("files")&&(p.updateFilesLists(e.files),p.updateStats(e.files)),console.log(e)}).always(function(){e.unblockUI()})}),e("#wp-optimize-nav-tab-wpo_minify-status-contents form :input, #wp-optimize-nav-tab-wpo_minify-js-contents form :input, #wp-optimize-nav-tab-wpo_minify-css-contents form :input, #wp-optimize-nav-tab-wpo_minify-font-contents form :input, #wp-optimize-nav-tab-wpo_minify-settings-contents form :input, #wp-optimize-nav-tab-wpo_minify-advanced-contents form :input").on("change",function(){e(this).closest("form").data("need_saving",!0)}),e("input[type=checkbox].wpo-save-setting").on("change",function(t){var n=e(this),s=n.prop("checked"),a=n.prop("name"),o={};o[a]=s,e.blockUI(),i("save_minify_settings",o,function(e){e.success?(n.trigger("wp-optimize/minify/saved_setting"),e.hasOwnProperty("files")&&(p.updateFilesLists(e.files),p.updateStats(e.files))):console.log("Settings not saved",o)}).always(function(){e.unblockUI()})}),e("#wpo_min_enable_minify").on("wp-optimize/minify/saved_setting",function(){this.enabled=e(this).prop("checked"),e(document).trigger("wp-optimize/minify/toggle-status",{enabled:this.enabled})}),e("#wpo_min_enable_minify").on("wp-optimize/minify/saved_setting",function(){e(this).closest(".wpo_section").toggleClass("wpo-feature-is-disabled",!e(this).is(":checked"))}),e("#wpo_min_enable_minify_css, #wpo_min_enable_minify_js").on("wp-optimize/minify/saved_setting",function(){e('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="'+e(this).data("tabname")+'"] span.disabled').toggleClass("hidden",e(this).is(":checked"))}).each(function(){e('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="'+e(this).data("tabname")+'"] span.disabled').toggleClass("hidden",e(this).is(":checked"))}),e("#wpo_min_enable_minify_debug").on("wp-optimize/minify/saved_setting",function(){e.blockUI({message:"<h1>"+wpoptimize.page_refresh+"</h1>"}),location.href=e("#wp-optimize-nav-tab-wpo_minify-advanced").prop("href")}),e("#wpo_min_edit_default_exclutions").on("wp-optimize/minify/saved_setting",function(){e(".wpo-minify-default-exclusions").toggleClass("hidden",!e(this).prop("checked"))}),e(".wp-optimize-save-minify-settings").on("click",function(t){function n(t){var i=e(t).serializeArray().reduce(s,{});return e(t).find('input[type="checkbox"]').each(function(t){var n=e(this).prop("name");if(n.includes("[]")){if(!e(this).is(":checked"))return;var s=n.replace("[]","");i[s]||(i[s]=[]),i[s].push(e(this).val())}else i[n]=e(this).is(":checked")?"true":"false"}),i}function s(e,t){return t.name.includes("[]")?e:(e[t.name]=t.value,e)}t.preventDefault();var a=e(this),o=a.next(),c=o.next();o.show(),e.blockUI();var l={},d=e('[data-whichpage="wpo_minify"] .wp-optimize-nav-tab-contents form');d.each(function(){var t=e(this);!0===t.data("need_saving")&&(l=Object.assign(l,n(t)),t.data("need_saving",!1))}),i("save_minify_settings",l,function(t){t.hasOwnProperty("error")?(console.log(t.error),e(".wpo-error__enabling-cache").removeClass("wpo_hidden").find("p").text(t.error.message)):e(".wpo-error__enabling-cache").addClass("wpo_hidden").find("p").text(""),t.hasOwnProperty("files")&&(p.updateFilesLists(t.files),p.updateStats(t.files)),o.hide(),c.show(),setTimeout(function(){c.fadeOut("slow",function(){c.hide()})},5e3)}).always(function(){e.unblockUI()})}),e(".wp-optimize-minify-status-information-notice").on("click",".notice-dismiss",function(e){e.preventDefault(),i("hide_minify_notice")}),e("#wpo_min_jsprocessed, #wpo_min_cssprocessed").on("click",".log",function(t){t.preventDefault(),e(this).nextAll(".wpo_min_log").slideToggle("fast")}),e("#wpo_min_jsprocessed").on("click",".exclude",function(i){i.preventDefault();var s=e(this),c=t(s);n(c),a("js"),o(s)}),e("#wpo_min_cssprocessed").on("click",".exclude",function(i){i.preventDefault();var n=e(this),c=t(n);s(c),a("css"),o(n)}),e(".save_notice").on("click",".save-exclusions",function(t){t.preventDefault(),e(".wp-optimize-save-minify-settings").first().trigger("click")}),this.enabled=e("#wpo_min_enable_minify").prop("checked"),e(document).trigger("wp-optimize/minify/toggle-status",{enabled:this.enabled}),this.enabled||e('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="status"]').is(".nav-tab-active")||e('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="status"]').trigger("click"),e('input[name="enable_defer_js"]').on("change",c),c(),this},s.getFiles=function(){if(this.enabled){var e={stamp:(new Date).getTime()};i("get_minify_cached_files",e,function(e){s.updateFilesLists(e),s.updateStats(e)}),n&&setTimeout(s.getFiles.bind(this),n)}},s.updateFilesLists=function(t){var i=[];t.js.length>0&&e(t.js).each(function(){i.push(this.uid),0==e("#"+this.uid).length&&e("#wpo_min_jsprocessed ul.processed").append('\t\t\t\t\t<li id="'+this.uid+'">\t\t\t\t\t\t<span class="filename"><a href="'+this.file_url+'" target="_blank">'+this.filename+"</a> ("+this.fsize+')</span>\t\t\t\t\t\t<a href="#" class="log">'+wpoptimize.toggle_info+'</a>\t\t\t\t\t\t<div class="hidden save_notice">\t\t\t\t\t\t\t<p>'+wpoptimize.excluded+'</p>\t\t\t\t\t\t\t<p><button class="button button-primary save-exclusions">'+wpoptimize.save_exclusions+'</button></p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="hidden wpo_min_log">'+this.log+"</div>\t\t\t\t\t</li>\t\t\t\t")}),e("#wpo_min_jsprocessed ul.processed .no-files-yet").toggle(!t.js.length),t.css.length>0&&e(t.css).each(function(){i.push(this.uid),0==e("#"+this.uid).length&&e("#wpo_min_cssprocessed ul.processed").append('\t\t\t\t\t<li id="'+this.uid+'">\t\t\t\t\t\t<span class="filename"><a href="'+this.file_url+'" target="_blank">'+this.filename+"</a> ("+this.fsize+')</span>\t\t\t\t\t\t<a href="#" class="log">'+wpoptimize.toggle_info+'</a>\t\t\t\t\t\t<div class="hidden save_notice">\t\t\t\t\t\t\t<p>'+wpoptimize.excluded+'</p>\t\t\t\t\t\t\t<p><button class="button button-primary save-exclusions">'+wpoptimize.save_exclusions+'</button></p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="hidden wpo_min_log">'+this.log+"</div>\t\t\t\t\t</li>\t\t\t\t")}),e("#wpo_min_cssprocessed ul.processed .no-files-yet").toggle(!t.css.length),e("#wpo_min_jsprocessed ul.processed > li, #wpo_min_cssprocessed ul.processed > li").each(function(){-1==jQuery.inArray(e(this).attr("id"),i)&&(e(this).is(".no-files-yet")||e(this).remove())})},s.updateStats=function(t){t.cachesize.length>0&&(e("#wpo_min_cache_size").html(t.cachesize),e("#wpo_min_cache_total_size").html(t.total_cache_size),e("#wpo_min_cache_time").html(t.cacheTime),e("#wpo_min_cache_path").html(t.cachePath))},t.minify=s}(jQuery);